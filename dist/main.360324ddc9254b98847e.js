!function(){"use strict";var e,t={180:function(e,t,n){n(147),n(892),n(192),n(245),n(205),n(753),n(132),n(655),n(731),n(107),n(905),n(523),n(197),n(244),n(162),n(804),n(160),n(688),n(511),n(314);var s={meta:{code:"pt",name:"Português",nativeName:"Português (Brasil)",direction:"ltr"},app:{title:"mark2 - Markdown para Mapa Mental",description:"Transforme texto Markdown em mapas mentais interativos",loading:"Carregando...",error:"Erro",success:"Sucesso"},header:{title:"mark2",subtitle:"Markdown para Mapa Mental"},buttons:{save:"Salvar",cancel:"Cancelar",close:"Fechar",clear:"Limpar",example:"Exemplo",export:"Exportar",import:"Importar",help:"Ajuda",settings:"Configurações",theme:"Tema",language:"Idioma",zoomIn:"Aumentar zoom",zoomOut:"Diminuir zoom",fitScreen:"Ajustar à tela",reset:"Resetar",copy:"Copiar",paste:"Colar",undo:"Desfazer",redo:"Refazer"},editor:{title:"Editor Markdown",placeholder:"Digite seu texto markdown aqui...\n\nExemplo:\n# Título Principal\n## Subtítulo\n- Item da lista\n- Outro item",wordCount:"palavras",lineCount:"linhas",characterCount:"caracteres",saved:"Salvo automaticamente",unsaved:"Alterações não salvas"},mindMap:{title:"Mapa Mental",generating:"Gerando mapa mental...",empty:"Digite texto markdown para ver seu mapa mental",error:"Não foi possível gerar o mapa mental",errorDetails:"Verifique se o texto markdown está formatado corretamente",nodeSelected:"Nó selecionado",nodeEdit:"Clique duas vezes para editar",nodeDelete:"Pressione Delete para remover",connectionHover:"Conexão entre nós",zoomLevel:"Nível de zoom: {level}%"},themes:{title:"Escolher Tema",light:"Claro",dark:"Escuro",blue:"Azul",green:"Verde",orange:"Laranja",description:{light:"Fundo branco limpo com texto preto",dark:"Modo escuro para uso confortável em pouca luz",blue:"Paleta de cores azul profissional",green:"Tons de verde inspirados na natureza",orange:"Tema laranja energético"}},languages:{title:"Escolher Idioma",portuguese:"Português",english:"English",spanish:"Español",systemDefault:"Padrão do sistema"},help:{title:"Como usar o mark2",introduction:"O mark2 cria mapas mentais organizados em hierarquia radial, com cores diferentes para cada nível:",hierarchy:{title:"Estrutura Hierárquica:",center:"Centro: Título principal (#) - núcleo do mapa",sections:"Primeiro nível: Seções (##) em azul - conectadas ao centro",subsections:"Segundo nível: Subsections (###) em roxo - filhas das seções",items:"Terceiro nível: Itens (-) em verde - filhos das subsections"},instructions:{headers:"Use # para o tópico central (aparece no centro do mapa)",subheaders:"Use ## para seções principais (nós azuis ao redor do centro)",subsubheaders:"Use ### para subsections (nós roxos, filhos das seções)",bullets:"Use - para itens específicos (nós verdes, filhos das subsections)",numbers:"Use números para listas ordenadas",text:"Texto puro serve como documentação e contexto (não vira nós visuais)"},supportText:{title:"Texto de Apoio:",description:'Texto sem marcação (como "O Atomic Design é uma metodologia...") serve para:',documentation:"• Documentação e explicações detalhadas",context:"• Contexto e informações complementares",reference:"• Material de referência e apoio",note:"Este texto não aparece como nós no mapa, mas ajuda a entender o conteúdo."},example:'Clique em "Exemplo" para ver como "Conceitos Fundamentais" usa texto de apoio.',tips:{title:"Navegação:",zoom:"Use os controles de zoom para navegar pelo mapa",drag:"Arraste para mover a visualização",select:"Clique nos nós para selecioná-los",hierarchy:"Observe as cores: azul → roxo → verde = hierarquia"}},export:{title:"Exportar Mapa Mental",formats:{png:"Imagem PNG",svg:"Vetor SVG",pdf:"Documento PDF",json:"Dados JSON"},options:{includeBackground:"Incluir fundo",highResolution:"Alta resolução",transparent:"Fundo transparente"},success:"Mapa mental exportado com sucesso",error:"Erro ao exportar mapa mental"},settings:{title:"Configurações",general:"Geral",appearance:"Aparência",editor:"Editor",mindMap:"Mapa Mental",options:{autoSave:"Salvamento automático",wordWrap:"Quebra de linha automática",lineNumbers:"Números de linha",minimap:"Mini mapa",animations:"Animações",sounds:"Sons",notifications:"Notificações"}},accessibility:{close:"Fechar",menu:"Menu",navigation:"Navegação",main:"Conteúdo principal",sidebar:"Barra lateral",toolbar:"Barra de ferramentas",dialog:"Diálogo",button:"Botão",textInput:"Campo de texto",checkbox:"Caixa de seleção",radioButton:"Botão de opção",select:"Seletor",link:"Link",image:"Imagem",video:"Vídeo",audio:"Áudio"},errors:{general:"Ocorreu um erro inesperado",network:"Erro de conexão de rede",fileNotFound:"Arquivo não encontrado",invalidFormat:"Formato de arquivo inválido",saveError:"Erro ao salvar",loadError:"Erro ao carregar",parseError:"Erro ao analisar markdown",renderError:"Erro ao renderizar mapa mental",permissionDenied:"Permissão negada",quotaExceeded:"Limite de armazenamento excedido"},success:{saved:"Salvo com sucesso",loaded:"Carregado com sucesso",exported:"Exportado com sucesso",imported:"Importado com sucesso",copied:"Copiado para a área de transferência",reset:"Configurações resetadas"},file:{new:"Novo",open:"Abrir",save:"Salvar",saveAs:"Salvar como",recent:"Recentes",untitled:"Sem título",modified:"Modificado",size:"Tamanho",created:"Criado",modified:"Modificado"},mobile:{editor:"Editor",mindMap:"Mapa",menu:"Menu",back:"Voltar",fullscreen:"Tela cheia",exitFullscreen:"Sair da tela cheia"},time:{now:"agora",today:"hoje",yesterday:"ontem",lastWeek:"semana passada",lastMonth:"mês passado",minute:"minuto",minutes:"minutos",hour:"hora",hours:"horas",day:"dia",days:"dias",week:"semana",weeks:"semanas",month:"mês",months:"meses",year:"ano",years:"anos"},examples:{atomicDesign:{title:"Exemplo: Atomic Design",description:"Demonstração de como estruturar componentes usando Atomic Design"},projectPlanning:{title:"Exemplo: Planejamento de Projeto",description:"Como organizar fases e tarefas de um projeto"},studyNotes:{title:"Exemplo: Notas de Estudo",description:"Estruturação de conteúdo acadêmico em mapa mental"}}},i={meta:{code:"en",name:"English",nativeName:"English",direction:"ltr"},app:{title:"mark2 - Markdown to Mind Map",description:"Transform Markdown text into interactive mind maps",loading:"Loading...",error:"Error",success:"Success"},header:{title:"mark2",subtitle:"Markdown to Mind Map"},buttons:{save:"Save",cancel:"Cancel",close:"Close",clear:"Clear",example:"Example",export:"Export",import:"Import",help:"Help",settings:"Settings",theme:"Theme",language:"Language",zoomIn:"Zoom in",zoomOut:"Zoom out",fitScreen:"Fit to screen",reset:"Reset",copy:"Copy",paste:"Paste",undo:"Undo",redo:"Redo"},editor:{title:"Markdown Editor",placeholder:"Enter your markdown text here...\n\nExample:\n# Main Title\n## Subtitle\n- List item\n- Another item",wordCount:"words",lineCount:"lines",characterCount:"characters",saved:"Auto-saved",unsaved:"Unsaved changes"},mindMap:{title:"Mind Map",generating:"Generating mind map...",empty:"Enter markdown text to see your mind map",error:"Unable to generate mind map",errorDetails:"Please check if the markdown text is properly formatted",nodeSelected:"Node selected",nodeEdit:"Double-click to edit",nodeDelete:"Press Delete to remove",connectionHover:"Connection between nodes",zoomLevel:"Zoom level: {level}%"},themes:{title:"Choose Theme",light:"Light",dark:"Dark",blue:"Blue",green:"Green",orange:"Orange",description:{light:"Clean white background with black text",dark:"Dark mode for comfortable low-light usage",blue:"Professional blue color palette",green:"Nature-inspired green tones",orange:"Energetic orange theme"}},languages:{title:"Choose Language",portuguese:"Português",english:"English",spanish:"Español",systemDefault:"System default"},help:{title:"How to use mark2",introduction:"mark2 creates mind maps organized in radial hierarchy, with different colors for each level:",hierarchy:{title:"Hierarchical Structure:",center:"Center: Main title (#) - core of the map",sections:"First level: Sections (##) in blue - connected to center",subsections:"Second level: Subsections (###) in purple - children of sections",items:"Third level: Items (-) in green - children of subsections"},instructions:{headers:"Use # for the central topic (appears at the center of the map)",subheaders:"Use ## for main sections (blue nodes around the center)",subsubheaders:"Use ### for subsections (purple nodes, children of sections)",bullets:"Use - for specific items (green nodes, children of subsections)",numbers:"Use numbers for ordered lists",text:"Plain text serves as documentation and context (does not become visual nodes)"},supportText:{title:"Support Text:",description:'Text without markup (like "Atomic Design is a methodology...") serves for:',documentation:"• Documentation and detailed explanations",context:"• Context and complementary information",reference:"• Reference material and support",note:"This text does not appear as nodes in the map, but helps understand the content."},example:'Click "Example" to see how "Fundamental Concepts" uses support text.',tips:{title:"Navigation:",zoom:"Use zoom controls to navigate the map",drag:"Drag to move the view",select:"Click nodes to select them",hierarchy:"Notice the colors: blue → purple → green = hierarchy"}},export:{title:"Export Mind Map",formats:{png:"PNG Image",svg:"SVG Vector",pdf:"PDF Document",json:"JSON Data"},options:{includeBackground:"Include background",highResolution:"High resolution",transparent:"Transparent background"},success:"Mind map exported successfully",error:"Error exporting mind map"},settings:{title:"Settings",general:"General",appearance:"Appearance",editor:"Editor",mindMap:"Mind Map",options:{autoSave:"Auto-save",wordWrap:"Word wrap",lineNumbers:"Line numbers",minimap:"Minimap",animations:"Animations",sounds:"Sounds",notifications:"Notifications"}},accessibility:{close:"Close",menu:"Menu",navigation:"Navigation",main:"Main content",sidebar:"Sidebar",toolbar:"Toolbar",dialog:"Dialog",button:"Button",textInput:"Text input",checkbox:"Checkbox",radioButton:"Radio button",select:"Select",link:"Link",image:"Image",video:"Video",audio:"Audio"},errors:{general:"An unexpected error occurred",network:"Network connection error",fileNotFound:"File not found",invalidFormat:"Invalid file format",saveError:"Error saving",loadError:"Error loading",parseError:"Error parsing markdown",renderError:"Error rendering mind map",permissionDenied:"Permission denied",quotaExceeded:"Storage quota exceeded"},success:{saved:"Saved successfully",loaded:"Loaded successfully",exported:"Exported successfully",imported:"Imported successfully",copied:"Copied to clipboard",reset:"Settings reset"},file:{new:"New",open:"Open",save:"Save",saveAs:"Save as",recent:"Recent",untitled:"Untitled",modified:"Modified",size:"Size",created:"Created",modified:"Modified"},mobile:{editor:"Editor",mindMap:"Mind Map",menu:"Menu",back:"Back",fullscreen:"Fullscreen",exitFullscreen:"Exit fullscreen"},time:{now:"now",today:"today",yesterday:"yesterday",lastWeek:"last week",lastMonth:"last month",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",week:"week",weeks:"weeks",month:"month",months:"months",year:"year",years:"years"},examples:{atomicDesign:{title:"Example: Atomic Design",description:"Demonstration of how to structure components using Atomic Design"},projectPlanning:{title:"Example: Project Planning",description:"How to organize project phases and tasks"},studyNotes:{title:"Example: Study Notes",description:"Structuring academic content as a mind map"}}},a={meta:{code:"es",name:"Español",nativeName:"Español",direction:"ltr"},app:{title:"mark2 - Markdown a Mapa Mental",description:"Transforma texto Markdown en mapas mentales interactivos",loading:"Cargando...",error:"Error",success:"Éxito"},header:{title:"mark2",subtitle:"Markdown a Mapa Mental"},buttons:{save:"Guardar",cancel:"Cancelar",close:"Cerrar",clear:"Limpiar",example:"Ejemplo",export:"Exportar",import:"Importar",help:"Ayuda",settings:"Configuración",theme:"Tema",language:"Idioma",zoomIn:"Acercar",zoomOut:"Alejar",fitScreen:"Ajustar a pantalla",reset:"Restablecer",copy:"Copiar",paste:"Pegar",undo:"Deshacer",redo:"Rehacer"},editor:{title:"Editor Markdown",placeholder:"Ingresa tu texto markdown aquí...\n\nEjemplo:\n# Título Principal\n## Subtítulo\n- Elemento de lista\n- Otro elemento",wordCount:"palabras",lineCount:"líneas",characterCount:"caracteres",saved:"Guardado automáticamente",unsaved:"Cambios no guardados"},mindMap:{title:"Mapa Mental",generating:"Generando mapa mental...",empty:"Ingresa texto markdown para ver tu mapa mental",error:"No se pudo generar el mapa mental",errorDetails:"Por favor verifica que el texto markdown esté formateado correctamente",nodeSelected:"Nodo seleccionado",nodeEdit:"Doble clic para editar",nodeDelete:"Presiona Suprimir para eliminar",connectionHover:"Conexión entre nodos",zoomLevel:"Nivel de zoom: {level}%"},themes:{title:"Elegir Tema",light:"Claro",dark:"Oscuro",blue:"Azul",green:"Verde",orange:"Naranja",description:{light:"Fondo blanco limpio con texto negro",dark:"Modo oscuro para uso cómodo con poca luz",blue:"Paleta de colores azul profesional",green:"Tonos verdes inspirados en la naturaleza",orange:"Tema naranja energético"}},languages:{title:"Elegir Idioma",portuguese:"Português",english:"English",spanish:"Español",systemDefault:"Predeterminado del sistema"},help:{title:"Cómo usar mark2",introduction:"mark2 crea mapas mentales organizados en jerarquía radial, con colores diferentes para cada nivel:",hierarchy:{title:"Estructura Jerárquica:",center:"Centro: Título principal (#) - núcleo del mapa",sections:"Primer nivel: Secciones (##) en azul - conectadas al centro",subsections:"Segundo nivel: Subsecciones (###) en morado - hijas de las secciones",items:"Tercer nivel: Elementos (-) en verde - hijos de las subsecciones"},instructions:{headers:"Usa # para el tópico central (aparece en el centro del mapa)",subheaders:"Usa ## para secciones principales (nodos azules alrededor del centro)",subsubheaders:"Usa ### para subsecciones (nodos morados, hijos de las secciones)",bullets:"Usa - para elementos específicos (nodos verdes, hijos de las subsecciones)",numbers:"Usa números para listas ordenadas",text:"Texto puro sirve como documentación y contexto (no se convierte en nodos visuales)"},supportText:{title:"Texto de Apoyo:",description:'Texto sin marcado (como "El Diseño Atómico es una metodología...") sirve para:',documentation:"• Documentación y explicaciones detalladas",context:"• Contexto e información complementaria",reference:"• Material de referencia y apoyo",note:"Este texto no aparece como nodos en el mapa, pero ayuda a entender el contenido."},example:'Haz clic en "Ejemplo" para ver cómo "Conceptos Fundamentales" usa texto de apoyo.',tips:{title:"Navegación:",zoom:"Usa los controles de zoom para navegar el mapa",drag:"Arrastra para mover la vista",select:"Haz clic en los nodos para seleccionarlos",hierarchy:"Observa los colores: azul → morado → verde = jerarquía"}},export:{title:"Exportar Mapa Mental",formats:{png:"Imagen PNG",svg:"Vector SVG",pdf:"Documento PDF",json:"Datos JSON"},options:{includeBackground:"Incluir fondo",highResolution:"Alta resolución",transparent:"Fondo transparente"},success:"Mapa mental exportado exitosamente",error:"Error al exportar mapa mental"},settings:{title:"Configuración",general:"General",appearance:"Apariencia",editor:"Editor",mindMap:"Mapa Mental",options:{autoSave:"Guardado automático",wordWrap:"Ajuste de línea",lineNumbers:"Números de línea",minimap:"Minimapa",animations:"Animaciones",sounds:"Sonidos",notifications:"Notificaciones"}},accessibility:{close:"Cerrar",menu:"Menú",navigation:"Navegación",main:"Contenido principal",sidebar:"Barra lateral",toolbar:"Barra de herramientas",dialog:"Diálogo",button:"Botón",textInput:"Entrada de texto",checkbox:"Casilla de verificación",radioButton:"Botón de opción",select:"Selector",link:"Enlace",image:"Imagen",video:"Video",audio:"Audio"},errors:{general:"Ocurrió un error inesperado",network:"Error de conexión de red",fileNotFound:"Archivo no encontrado",invalidFormat:"Formato de archivo inválido",saveError:"Error al guardar",loadError:"Error al cargar",parseError:"Error al analizar markdown",renderError:"Error al renderizar mapa mental",permissionDenied:"Permiso denegado",quotaExceeded:"Cuota de almacenamiento excedida"},success:{saved:"Guardado exitosamente",loaded:"Cargado exitosamente",exported:"Exportado exitosamente",imported:"Importado exitosamente",copied:"Copiado al portapapeles",reset:"Configuración restablecida"},file:{new:"Nuevo",open:"Abrir",save:"Guardar",saveAs:"Guardar como",recent:"Recientes",untitled:"Sin título",modified:"Modificado",size:"Tamaño",created:"Creado",modified:"Modificado"},mobile:{editor:"Editor",mindMap:"Mapa",menu:"Menú",back:"Atrás",fullscreen:"Pantalla completa",exitFullscreen:"Salir de pantalla completa"},time:{now:"ahora",today:"hoy",yesterday:"ayer",lastWeek:"semana pasada",lastMonth:"mes pasado",minute:"minuto",minutes:"minutos",hour:"hora",hours:"horas",day:"día",days:"días",week:"semana",weeks:"semanas",month:"mes",months:"meses",year:"año",years:"años"},examples:{atomicDesign:{title:"Ejemplo: Diseño Atómico",description:"Demostración de cómo estructurar componentes usando Diseño Atómico"},projectPlanning:{title:"Ejemplo: Planificación de Proyecto",description:"Cómo organizar fases y tareas de un proyecto"},studyNotes:{title:"Ejemplo: Notas de Estudio",description:"Estructuración de contenido académico en mapa mental"}}},o=new class{constructor(){this.languages={pt:s,en:i,es:a},this.defaultLanguage="pt",this.currentLanguage=this.defaultLanguage,this.fallbackLanguage="en",this.subscribers=[],this.init()}init(){this.loadStoredLanguage(),this.applyLanguage(this.currentLanguage),this.listenForSystemLanguageChanges()}loadStoredLanguage(){try{const e=localStorage.getItem("preferred-language");e&&this.isLanguageAvailable(e)?this.currentLanguage=e:this.currentLanguage=this.detectSystemLanguage()}catch(e){console.warn("Could not load language from localStorage:",e),this.currentLanguage=this.defaultLanguage}}detectSystemLanguage(){if("undefined"==typeof navigator)return this.defaultLanguage;const e=(navigator.language||navigator.languages?.[0]||this.defaultLanguage).split("-")[0].toLowerCase();return this.isLanguageAvailable(e)?e:this.defaultLanguage}isLanguageAvailable(e){return Object.keys(this.languages).includes(e)}setLanguage(e){if(!this.isLanguageAvailable(e))return console.warn(`Language '${e}' is not available. Available languages:`,Object.keys(this.languages)),!1;const t=this.currentLanguage;return this.currentLanguage=e,this.applyLanguage(e),this.storeLanguage(e),this.notifySubscribers(e,t),!0}applyLanguage(e){if("undefined"==typeof document)return;document.documentElement.lang=e;const t=this.languages[e];t?.meta?.direction&&(document.documentElement.dir=t.meta.direction),t?.app?.title&&(document.title=t.app.title);const n=document.querySelector('meta[name="description"]');n&&t?.app?.description&&(n.content=t.app.description)}storeLanguage(e){try{localStorage.setItem("preferred-language",e)}catch(e){console.warn("Could not store language in localStorage:",e)}}getCurrentLanguage(){return this.currentLanguage}getAvailableLanguages(){return Object.keys(this.languages).map(e=>({code:e,name:this.languages[e].meta?.name||e,nativeName:this.languages[e].meta?.nativeName||e,direction:this.languages[e].meta?.direction||"ltr"}))}getLanguageDisplayName(e){const t=this.languages[e];return t?.meta?.nativeName||t?.meta?.name||e}t(e,t={}){return this.translate(e,t)}translate(e,t={}){const n=this.getTranslation(e,this.currentLanguage);if(null===n){const n=this.getTranslation(e,this.fallbackLanguage);return null!==n?(console.warn(`Translation missing for key '${e}' in language '${this.currentLanguage}', using fallback`),this.interpolate(n,t)):(console.warn(`Translation missing for key '${e}' in both current and fallback languages`),e)}return this.interpolate(n,t)}getTranslation(e,t){const n=this.languages[t];if(!n)return null;const s=e.split(".");let i=n;for(const e of s){if(!i||"object"!=typeof i||!(e in i))return null;i=i[e]}return"string"==typeof i?i:null}interpolate(e,t){return t&&0!==Object.keys(t).length?e.replace(/\{([^}]+)\}/g,(e,n)=>void 0!==t[n]?t[n]:e):e}plural(e,t,n={}){const s=this.getPluralKey(e,t),i={...n,count:t};return this.translate(s,i)}getPluralKey(e,t){return 1===t?`${e}.one`:`${e}.other`}formatTime(e,t){return 1===t?`1 ${this.translate(`time.${e}`)}`:`${t} ${this.translate(`time.${e}s`)}`}formatDate(e,t={}){const n=this.languages[this.currentLanguage],s=n?.meta?.code||this.currentLanguage;try{return new Intl.DateTimeFormat(s,t).format(e)}catch(t){return console.warn("Error formatting date:",t),e.toString()}}formatNumber(e,t={}){const n=this.languages[this.currentLanguage],s=n?.meta?.code||this.currentLanguage;try{return new Intl.NumberFormat(s,t).format(e)}catch(t){return console.warn("Error formatting number:",t),e.toString()}}formatCurrency(e,t="USD",n={}){return this.formatNumber(e,{style:"currency",currency:t,...n})}subscribe(e){if("function"==typeof e)return this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);t>-1&&this.subscribers.splice(t,1)}}notifySubscribers(e,t){this.subscribers.forEach(n=>{try{n(e,t)}catch(e){console.error("Error in language change subscriber:",e)}})}listenForSystemLanguageChanges(){"undefined"!=typeof window&&window.addEventListener("languagechange",()=>{if(!localStorage.getItem("preferred-language")){const e=this.detectSystemLanguage();this.setLanguage(e)}})}resetToSystemLanguage(){try{localStorage.removeItem("preferred-language");const e=this.detectSystemLanguage();this.setLanguage(e)}catch(e){console.warn("Could not reset to system language:",e)}}addLanguage(e,t){return this.isLanguageAvailable(e)?(console.warn(`Language '${e}' already exists. Use updateLanguage() to modify it.`),!1):(this.languages[e]=t,!0)}updateLanguage(e,t){return this.isLanguageAvailable(e)?(this.languages[e]={...this.languages[e],...t},e===this.currentLanguage&&(this.applyLanguage(e),this.notifySubscribers(e,e)),!0):(console.warn(`Language '${e}' does not exist. Use addLanguage() to create it.`),!1)}removeLanguage(e){return e===this.defaultLanguage?(console.warn("Cannot remove default language"),!1):!!this.isLanguageAvailable(e)&&(delete this.languages[e],e===this.currentLanguage&&this.setLanguage(this.defaultLanguage),!0)}exportLanguageSettings(){return{currentLanguage:this.currentLanguage,availableLanguages:Object.keys(this.languages),systemLanguage:this.detectSystemLanguage()}}importLanguageSettings(e){return!!(e&&e.currentLanguage&&this.isLanguageAvailable(e.currentLanguage))&&(this.setLanguage(e.currentLanguage),!0)}destroy(){this.subscribers=[]}},r=new class{constructor(){this.themes=["light","dark","blue","green","orange"],this.currentTheme="light",this.subscribers=[],this.init()}init(){this.loadStoredTheme(),this.applyTheme(this.currentTheme),this.listenForSystemThemeChanges()}loadStoredTheme(){try{const e=localStorage.getItem("preferred-theme");e&&this.themes.includes(e)?this.currentTheme=e:this.currentTheme=this.getSystemTheme()}catch(e){console.warn("Could not load theme from localStorage:",e),this.currentTheme="light"}}getSystemTheme(){return"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}setTheme(e){if(!this.themes.includes(e))return console.warn(`Theme '${e}' is not available. Available themes:`,this.themes),!1;const t=this.currentTheme;return this.currentTheme=e,this.applyTheme(e),this.storeTheme(e),this.notifySubscribers(e,t),!0}applyTheme(e){"undefined"!=typeof document&&(this.themes.forEach(e=>{document.body.classList.remove(`theme-${e}`),document.documentElement.classList.remove(`theme-${e}`)}),document.documentElement.classList.add(`theme-${e}`),this.updateMetaThemeColor(e))}updateMetaThemeColor(e){const t={light:"#ffffff",dark:"#0f172a",blue:"#eff6ff",green:"#f0fdf4",orange:"#fff7ed"};let n=document.querySelector('meta[name="theme-color"]');n||(n=document.createElement("meta"),n.name="theme-color",document.head.appendChild(n)),n.content=t[e]||t.light}storeTheme(e){try{localStorage.setItem("preferred-theme",e)}catch(e){console.warn("Could not store theme in localStorage:",e)}}getCurrentTheme(){return this.currentTheme}getAvailableThemes(){return[...this.themes]}getThemeDisplayName(e){return{light:"Light",dark:"Dark",blue:"Blue",green:"Green",orange:"Orange"}[e]||e}getThemeDescription(e){return{light:"Clean white background with black text",dark:"Dark mode for comfortable low-light usage",blue:"Professional blue color palette",green:"Nature-inspired green tones",orange:"Energetic orange theme"}[e]||""}toggleTheme(){const e=(this.themes.indexOf(this.currentTheme)+1)%this.themes.length;this.setTheme(this.themes[e])}cycleTheme(){this.toggleTheme()}subscribe(e){if("function"==typeof e)return this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);t>-1&&this.subscribers.splice(t,1)}}notifySubscribers(e,t){this.subscribers.forEach(n=>{try{n(e,t)}catch(e){console.error("Error in theme change subscriber:",e)}})}listenForSystemThemeChanges(){if("undefined"==typeof window||!window.matchMedia)return;const e=window.matchMedia("(prefers-color-scheme: dark)"),t=e=>{if(!localStorage.getItem("preferred-theme")){const t=e.matches?"dark":"light";this.setTheme(t)}};e.addEventListener?e.addEventListener("change",t):e.addListener(t)}resetToSystemTheme(){try{localStorage.removeItem("preferred-theme");const e=this.getSystemTheme();this.setTheme(e)}catch(e){console.warn("Could not reset to system theme:",e)}}exportThemeSettings(){return{currentTheme:this.currentTheme,availableThemes:this.themes,systemTheme:this.getSystemTheme()}}importThemeSettings(e){return!!(e&&e.currentTheme&&this.themes.includes(e.currentTheme))&&(this.setTheme(e.currentTheme),!0)}getCSSCustomProperty(e){return"undefined"==typeof document?null:getComputedStyle(document.documentElement).getPropertyValue(e).trim()}setCSSCustomProperty(e,t){"undefined"!=typeof document&&document.documentElement.style.setProperty(e,t)}destroy(){this.subscribers=[]}};const l=e=>{const t=[];let n=1;const s={id:n++,text:e.title,level:1,children:[]};return t.push(s),e.sections.forEach(e=>{const i={id:n++,text:e.title,level:2,parent:s.id,children:[]};t.push(i),s.children.push(i.id),e.items.forEach(e=>{const s={id:n++,text:e,level:3,parent:i.id,children:[]};t.push(s),i.children.push(s.id)}),e.subsections&&e.subsections.forEach(e=>{const s={id:n++,text:e.title,level:3,parent:i.id,children:[]};t.push(s),i.children.push(s.id),e.items.forEach(e=>{const i={id:n++,text:e,level:4,parent:s.id,children:[]};t.push(i),s.children.push(i.id)})})}),t},d=(e,t,n,s,i)=>{const a=t*s,o=2*Math.PI/e.length;e.forEach((e,t)=>{const s=t*o-Math.PI/2;e.x=n.x+a*Math.cos(s),e.y=n.y+a*Math.sin(s)})},c=e=>{const t=[];return e.forEach(n=>{if(n.parent){const s=e.find(e=>e.id===n.parent);s&&t.push({id:`connection-${s.id}-${n.id}`,from:s.id,to:n.id,fromX:s.x||0,fromY:s.y||0,toX:n.x||0,toY:n.y||0})}}),t},h=(e,t=800,n=600)=>{try{const s=((e,t={})=>{const{width:n=800,height:s=600,nodeSpacing:i=150,levelSpacing:a=200,centerX:o=n/2,centerY:r=s/2}=t;if(!e||0===e.length)return[];const l=[...e],c=l.find(e=>1===e.level);if(!c)return l;c.x=o,c.y=r;const h={};l.forEach(e=>{h[e.level]||(h[e.level]=[]),h[e.level].push(e)});const m=Object.keys(h).map(Number).sort((e,t)=>e-t);for(let e=1;e<m.length;e++){const t=m[e],n=h[t];d(n,t,c,a,i)}return l})(e.nodes,{width:t,height:n});return{nodes:s,connections:c(s),bounds:m(s),center:{x:t/2,y:n/2}}}catch(e){return console.error("Error generating layout:",e),{nodes:[],connections:[],bounds:{minX:0,minY:0,maxX:t,maxY:n},center:{x:t/2,y:n/2}}}},m=e=>{if(0===e.length)return{minX:0,minY:0,maxX:800,maxY:600};const t=e.map(e=>e.x||0),n=e.map(e=>e.y||0);return{minX:Math.min(...t)-100,minY:Math.min(...n)-100,maxX:Math.max(...t)+100,maxY:Math.max(...n)+100}};new class{constructor(){this.examples=new Map,this.loadExamples()}async loadExamples(){const e=this.getInlineExample("atomic-design.md");this.examples.set("atomic-design",{id:"atomic-design",title:"Atomic Design",description:"Sistema de design baseado em componentes",content:e,category:"design-systems"})}async loadExampleFile(e){try{const t=await fetch(`/src/examples/${e}`);if(!t.ok)throw new Error(`Failed to load example: ${t.status}`);return await t.text()}catch(t){return this.getInlineExample(e)}}getInlineExample(e){return{"atomic-design.md":"# Atomic Design\n\n## Conceitos Fundamentais\n### Metodologia de Design\n- Criada por Brad Frost\n- Inspirada na química\n- Hierarquia de componentes\n- Reutilização e consistência\n\n### Benefícios\n- Escalabilidade\n- Manutenibilidade\n- Consistência visual\n- Desenvolvimento eficiente\n- Documentação clara\n\n## Átomos (Atoms)\n### Elementos Básicos\n- Botões\n- Inputs\n- Labels\n- Icons\n- Tipografia\n\n### Características\n- Menor unidade funcional\n- Não podem ser decompostos\n- Altamente reutilizáveis\n- Propriedades básicas\n- Estados simples\n\n## Moléculas (Molecules)\n### Combinações Simples\n- Formulário de busca\n- Card de produto\n- Menu de navegação\n- Toolbar\n- Breadcrumb\n\n### Características\n- Agrupamento de átomos\n- Funcionalidade específica\n- Reutilizáveis em contextos\n- Interface mais complexa\n\n## Organismos (Organisms)\n### Seções Complexas\n- Header completo\n- Footer\n- Sidebar\n- Lista de produtos\n- Formulário completo\n\n### Características\n- Combinação de moléculas\n- Seções distintas da interface\n- Funcionalidade completa\n- Contexto específico\n\n## Templates\n### Estrutura de Página\n- Layout grid\n- Wireframes\n- Posicionamento\n- Hierarquia visual\n- Responsive design\n\n### Características\n- Esqueleto da página\n- Sem conteúdo real\n- Foco na estrutura\n- Guias de layout\n\n## Páginas (Pages)\n### Instâncias Reais\n- Homepage\n- Página de produto\n- Checkout\n- Dashboard\n- Perfil do usuário\n\n### Características\n- Template com conteúdo real\n- Casos de uso específicos\n- Testes de usabilidade\n- Validação do design"}[e]||"# Exemplo não encontrado\n\nO exemplo solicitado não pôde ser carregado."}getExample(e){return this.examples.get(e)}getAllExamples(){return Array.from(this.examples.values())}getExamplesByCategory(e){return this.getAllExamples().filter(t=>t.category===e)}async loadExampleContent(e){const t=this.getExample(e);if(!t)throw new Error(`Example with id "${e}" not found`);return t.content}addExample(e,t){this.examples.set(e,{id:e,title:t.title,description:t.description,content:t.content,category:t.category||"custom"})}removeExample(e){return this.examples.delete(e)}hasExample(e){return this.examples.has(e)}getExampleMetadata(e){const t=this.getExample(e);return t?{id:t.id,title:t.title,description:t.description,category:t.category}:null}};var u=class{constructor(e){this.container=e,this.svg=null,this.nodes=[],this.connections=[],this.zoom=1,this.panX=0,this.panY=0,this.isDragging=!1,this.lastMousePos={x:0,y:0},this.config={nodeWidth:180,nodeHeight:60,nodeSpacing:300,levelSpacing:280,itemSpacing:{radial:2.8,bullet:3.2,vertical:120,horizontal:500,minAngle:.5},layout:{bulletThreshold:2,collisionMargin:30},colors:{primary:"#2563eb",secondary:"#7c3aed",accent:"#059669",text:"#1f2937",textLight:"#6b7280",background:"#ffffff",stroke:"#e5e7eb"}}}render(e){console.log("Rendering mind map with data:",e),this.container.innerHTML="",this.createSVG(),this.processData(e),this.renderNodes(),this.renderConnections(),this.setupInteractivity(),this.fitToView()}createSVG(){this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("width","100%"),this.svg.setAttribute("height","100%"),this.svg.setAttribute("viewBox","0 0 1200 800"),this.svg.style.background=this.config.colors.background,this.svg.style.border=`1px solid ${this.config.colors.stroke}`,this.svg.style.borderRadius="8px";const e=document.createElementNS("http://www.w3.org/2000/svg","defs"),t=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");t.setAttribute("id","nodeGradient"),t.setAttribute("x1","0%"),t.setAttribute("y1","0%"),t.setAttribute("x2","100%"),t.setAttribute("y2","100%");const n=document.createElementNS("http://www.w3.org/2000/svg","stop");n.setAttribute("offset","0%"),n.setAttribute("stop-color",this.config.colors.primary);const s=document.createElementNS("http://www.w3.org/2000/svg","stop");s.setAttribute("offset","100%"),s.setAttribute("stop-color",this.config.colors.secondary),t.appendChild(n),t.appendChild(s),e.appendChild(t);const i=document.createElementNS("http://www.w3.org/2000/svg","filter");i.setAttribute("id","shadow"),i.setAttribute("x","-50%"),i.setAttribute("y","-50%"),i.setAttribute("width","200%"),i.setAttribute("height","200%");const a=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");a.setAttribute("dx","2"),a.setAttribute("dy","2"),a.setAttribute("stdDeviation","3"),a.setAttribute("flood-opacity","0.2"),i.appendChild(a),e.appendChild(i),this.svg.appendChild(e),this.mainGroup=document.createElementNS("http://www.w3.org/2000/svg","g"),this.mainGroup.setAttribute("id","main-group"),this.svg.appendChild(this.mainGroup),this.container.appendChild(this.svg)}processData(e){if(this.nodes=[],this.connections=[],!e||!e.sections)return;const t={id:"root",text:e.title||"Mapa Mental",x:600,y:400,level:0,type:"root",width:1.2*this.config.nodeWidth,height:1.2*this.config.nodeHeight};this.nodes.push(t);const n=2*Math.PI/e.sections.length,s=2*this.config.levelSpacing;e.sections.forEach((e,t)=>{const i=t*n,a=600+Math.cos(i)*s,o=400+Math.sin(i)*s,r={id:`section-${t}`,text:e.title,x:a,y:o,level:1,type:"section",width:this.config.nodeWidth,height:this.config.nodeHeight,parentId:"root"};this.nodes.push(r),this.connections.push({from:"root",to:`section-${t}`,type:"primary"});const l=[];if(e.items&&e.items.length>0&&e.items.forEach(e=>{l.push({text:e,type:"item",parentId:`section-${t}`})}),e.subsections&&e.subsections.length>0&&e.subsections.forEach((e,n)=>{l.push({text:e.title,type:"subsection",parentId:`section-${t}`,subsectionIndex:n,items:e.items||[]})}),l.length>0){const e=l.filter(e=>"item"===e.type),n=l.filter(e=>"subsection"===e.type);n.length>0&&this.layoutSubsectionsAsIntermediateLevel(n,a,o,i,t),e.length>0&&(e.length>=this.config.layout.bulletThreshold?this.layoutBulletsVertically(e,a,o,i,t):this.layoutItemsRadially(e,a,o,i,t))}})}layoutBulletsVertically(e,t,n,s,i){const a=this.config.itemSpacing.vertical,o=this.config.itemSpacing.horizontal,r=s>Math.PI?-1:1,l=n-(e.length-1)*a/2;e.forEach((e,n)=>{const s=t+o*r,d=l+n*a,c={id:`item-${i}-${n}`,text:e.text,x:s,y:d,level:3,type:"item",width:.8*this.config.nodeWidth,height:.8*this.config.nodeHeight,parentId:`section-${i}`};this.nodes.push(c),this.connections.push({from:`section-${i}`,to:`item-${i}-${n}`,type:"secondary"})})}layoutItemsRadially(e,t,n,s,i){const a=this.config.levelSpacing*this.config.itemSpacing.radial,o=1.4*Math.PI,r=this.config.itemSpacing.minAngle,l=o/Math.max(e.length,1),d=Math.max(l,r),c=s-Math.min(o,d*(e.length-1))/2;e.forEach((e,s)=>{const o=c+s*d,r=t+Math.cos(o)*a,l=n+Math.sin(o)*a;if("subsection"===e.type){const t={id:`subsection-${i}-${e.subsectionIndex}`,text:e.text,x:r,y:l,level:3,type:"subsection",width:.9*this.config.nodeWidth,height:.9*this.config.nodeHeight,parentId:`section-${i}`};if(this.nodes.push(t),this.connections.push({from:`section-${i}`,to:`subsection-${i}-${e.subsectionIndex}`,type:"secondary"}),e.items&&e.items.length>0){const t=1*this.config.levelSpacing,n=1.2*Math.PI/Math.max(e.items.length,1),s=o-n*(e.items.length-1)/2;e.items.forEach((a,o)=>{const d=s+o*n,c=r+Math.cos(d)*t,h=l+Math.sin(d)*t,m={id:`subitem-${i}-${e.subsectionIndex}-${o}`,text:a,x:c,y:h,level:4,type:"subitem",width:.7*this.config.nodeWidth,height:.7*this.config.nodeHeight,parentId:`subsection-${i}-${e.subsectionIndex}`};this.nodes.push(m),this.connections.push({from:`subsection-${i}-${e.subsectionIndex}`,to:`subitem-${i}-${e.subsectionIndex}-${o}`,type:"tertiary"})})}}else{const t={id:`item-${i}-${s}`,text:e.text,x:r,y:l,level:3,type:"item",width:.8*this.config.nodeWidth,height:.8*this.config.nodeHeight,parentId:`section-${i}`};this.nodes.push(t),this.connections.push({from:`section-${i}`,to:`item-${i}-${s}`,type:"secondary"})}})}processItemRadially(e,t,n,s,i,a,o){const r=this.config.levelSpacing*this.config.itemSpacing.radial,l=1.4*Math.PI/Math.max(o,1),d=i-l*(o-1)/2+t*l,c=n+Math.cos(d)*r,h=s+Math.sin(d)*r,m={id:`item-${a}-${t}`,text:e.text,x:c,y:h,level:3,type:"item",width:.8*this.config.nodeWidth,height:.8*this.config.nodeHeight,parentId:`section-${a}`};this.nodes.push(m),this.connections.push({from:`section-${a}`,to:`item-${a}-${t}`,type:"secondary"})}renderNodes(){this.nodes.forEach(e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","g");t.setAttribute("class",`mind-map-node mind-map-node--${e.type}`),t.setAttribute("data-node-id",e.id);const n=document.createElementNS("http://www.w3.org/2000/svg","rect");n.setAttribute("x",e.x-e.width/2),n.setAttribute("y",e.y-e.height/2),n.setAttribute("width",e.width),n.setAttribute("height",e.height),n.setAttribute("rx","root"===e.type?"20":"10"),n.setAttribute("ry","root"===e.type?"20":"10"),"root"===e.type?n.setAttribute("fill","url(#nodeGradient)"):"section"===e.type?n.setAttribute("fill",this.config.colors.primary):"subsection"===e.type?n.setAttribute("fill",this.config.colors.secondary):"subitem"===e.type?n.setAttribute("fill","#10b981"):n.setAttribute("fill",this.config.colors.accent),n.setAttribute("stroke",this.config.colors.stroke),n.setAttribute("stroke-width","2"),n.setAttribute("filter","url(#shadow)"),t.appendChild(n);const s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("x",e.x),s.setAttribute("y",e.y),s.setAttribute("text-anchor","middle"),s.setAttribute("dominant-baseline","middle");let i="#ffffff";"item"!==e.type&&"subitem"!==e.type||(i=this.config.colors.text),s.setAttribute("fill",i),s.setAttribute("font-family","var(--font-family)");let a="normal";"root"===e.type?a="bold":"section"===e.type?a="600":"subsection"===e.type&&(a="500"),s.setAttribute("font-weight",a);let o="12";"root"===e.type?o="16":"section"===e.type?o="14":"subsection"===e.type?o="13":"item"===e.type?o="12":"subitem"===e.type&&(o="11"),s.setAttribute("font-size",o);const r="root"===e.type?20:"section"===e.type?15:12;if(e.text.length>r){const t=e.text.split(" "),n=[];let i="";t.forEach(e=>{(i+e).length>r&&i?(n.push(i.trim()),i=e+" "):i+=e+" "}),i&&n.push(i.trim()),n.forEach((t,n)=>{const i=document.createElementNS("http://www.w3.org/2000/svg","tspan");i.setAttribute("x",e.x),i.setAttribute("dy",0===n?"0":"1.2em"),i.textContent=t,s.appendChild(i)})}else s.textContent=e.text;t.appendChild(s),t.style.cursor="pointer",t.addEventListener("click",()=>{console.log("Node clicked:",e.text),this.highlightNode(e.id)}),this.mainGroup.appendChild(t)})}renderConnections(){this.connections.forEach(e=>{const t=this.nodes.find(t=>t.id===e.from),n=this.nodes.find(t=>t.id===e.to);if(!t||!n)return;const s=document.createElementNS("http://www.w3.org/2000/svg","line");s.setAttribute("x1",t.x),s.setAttribute("y1",t.y),s.setAttribute("x2",n.x),s.setAttribute("y2",n.y),s.setAttribute("stroke","primary"===e.type?this.config.colors.primary:this.config.colors.accent),s.setAttribute("stroke-width","primary"===e.type?"3":"2"),s.setAttribute("stroke-opacity","0.6"),s.setAttribute("class",`mind-map-connection mind-map-connection--${e.type}`),this.mainGroup.insertBefore(s,this.mainGroup.firstChild)})}setupInteractivity(){this.container.addEventListener("wheel",e=>{e.preventDefault();const t=e.deltaY>0?.9:1.1;this.zoom=Math.max(.1,Math.min(3,this.zoom*t)),this.updateTransform()}),this.container.addEventListener("mousedown",e=>{e.target!==this.svg&&e.target!==this.container||(this.isDragging=!0,this.lastMousePos={x:e.clientX,y:e.clientY},this.container.style.cursor="grabbing")}),this.container.addEventListener("mousemove",e=>{if(this.isDragging){const t=e.clientX-this.lastMousePos.x,n=e.clientY-this.lastMousePos.y;this.panX+=t/this.zoom,this.panY+=n/this.zoom,this.lastMousePos={x:e.clientX,y:e.clientY},this.updateTransform()}}),this.container.addEventListener("mouseup",()=>{this.isDragging=!1,this.container.style.cursor="default"}),this.container.addEventListener("mouseleave",()=>{this.isDragging=!1,this.container.style.cursor="default"})}updateTransform(){this.mainGroup.setAttribute("transform",`translate(${this.panX}, ${this.panY}) scale(${this.zoom})`)}highlightNode(e){this.container.querySelectorAll(".mind-map-node").forEach(e=>{e.style.opacity="1"});const t=this.container.querySelector(`[data-node-id="${e}"]`);t&&(t.style.opacity="0.8",t.style.transform="scale(1.05)",setTimeout(()=>{t.style.transform="scale(1)"},200))}fitToView(){if(0===this.nodes.length)return;let e=1/0,t=-1/0,n=1/0,s=-1/0;this.nodes.forEach(i=>{const a=(i.width||this.config.nodeWidth)/2,o=(i.height||this.config.nodeHeight)/2;e=Math.min(e,i.x-a),t=Math.max(t,i.x+a),n=Math.min(n,i.y-o),s=Math.max(s,i.y+o)});const i=.8*this.config.nodeWidth,a=.8*this.config.nodeHeight;e-=i,t+=i,n-=a,s+=a;const o=t-e,r=s-n,l=(e+t)/2,d=(n+s)/2,c=this.container.getBoundingClientRect(),h=c.width/o,m=c.height/r;this.zoom=Math.max(.3,.95*Math.min(h,m,2)),this.panX=c.width/2-l*this.zoom,this.panY=c.height/2-d*this.zoom,this.updateTransform()}zoomIn(){this.zoom=Math.min(3,1.2*this.zoom),this.updateTransform()}zoomOut(){this.zoom=Math.max(.2,.8*this.zoom),this.updateTransform()}resetView(){this.fitToView()}layoutSubsectionsAsIntermediateLevel(e,t,n,s,i){const a=1.2*this.config.levelSpacing,o=.8*Math.PI/Math.max(1,e.length-1),r=s-.4*Math.PI;e.forEach((e,s)=>{const l=r+s*o,d=t+Math.cos(l)*a,c=n+Math.sin(l)*a,h={id:`subsection-${i}-${s}`,text:e.text,x:d,y:c,level:2,type:"subsection",width:.9*this.config.nodeWidth,height:.8*this.config.nodeHeight,parentId:`section-${i}`};if(this.nodes.push(h),this.connections.push({from:`section-${i}`,to:`subsection-${i}-${s}`,type:"secondary"}),e.items&&e.items.length>0){const t=.8*this.config.levelSpacing,n=.6*Math.PI/Math.max(1,e.items.length-1),a=l-.3*Math.PI;e.items.forEach((e,o)=>{const r=a+o*n,l=d+Math.cos(r)*t,h=c+Math.sin(r)*t,m={id:`bullet-${i}-${s}-${o}`,text:e,x:l,y:h,level:3,type:"subitem",width:.8*this.config.nodeWidth,height:.7*this.config.nodeHeight,parentId:`subsection-${i}-${s}`};this.nodes.push(m),this.connections.push({from:`subsection-${i}-${s}`,to:`bullet-${i}-${s}-${o}`,type:"tertiary"})})}})}},p=new class{constructor(){this.supportedFormats=["png","svg","pdf"]}async exportAsPNG(e,t={}){const{width:n=1200,height:s=800,scale:i=2,filename:a="mind-map.png",backgroundColor:o="#ffffff"}=t;try{const t=document.createElement("canvas"),r=t.getContext("2d");t.width=n*i,t.height=s*i,r.fillStyle=o,r.fillRect(0,0,t.width,t.height);const l=this.getSVGData(e,n,s),d=new Image;return new Promise((e,o)=>{d.onload=()=>{r.scale(i,i),r.drawImage(d,0,0,n,s),t.toBlob(t=>{t?(this.downloadBlob(t,a),e(t)):o(new Error("Failed to create image blob"))},"image/png",1)},d.onerror=()=>{o(new Error("Failed to load SVG as image"))},d.src="data:image/svg+xml;base64,"+btoa(l)})}catch(e){throw console.error("Error exporting as PNG:",e),e}}async exportAsSVG(e,t={}){const{filename:n="mind-map.svg",width:s=1200,height:i=800}=t;try{const t=this.getSVGData(e,s,i),a=new Blob([t],{type:"image/svg+xml;charset=utf-8"});return this.downloadBlob(a,n),a}catch(e){throw console.error("Error exporting as SVG:",e),e}}getSVGData(e,t,n){const s=e.cloneNode(!0);return s.setAttribute("width",t),s.setAttribute("height",n),s.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.inlineStyles(s),(new XMLSerializer).serializeToString(s)}inlineStyles(e){e.querySelectorAll("*").forEach(e=>{const t=window.getComputedStyle(e);["font-family","font-size","font-weight","fill","stroke","stroke-width","opacity","visibility"].forEach(n=>{const s=t.getPropertyValue(n);s&&"initial"!==s&&"inherit"!==s&&e.style.setProperty(n,s)})})}downloadBlob(e,t){const n=URL.createObjectURL(e),s=document.createElement("a");s.href=n,s.download=t,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)}showExportModal(e){if(!e)throw new Error("No SVG element provided for export");document.body.insertAdjacentHTML("beforeend",'\n      <div id="export-modal" class="molecule-modal" aria-hidden="false" role="dialog" aria-labelledby="export-modal-title">\n        <div class="molecule-modal__backdrop"></div>\n        <div class="molecule-modal__content">\n          <header class="molecule-modal__header">\n            <h3 id="export-modal-title">Export Mind Map</h3>\n            <button class="atom-button atom-button--ghost" id="export-modal-close" aria-label="Close export">✕</button>\n          </header>\n          <div class="molecule-modal__body">\n            <div class="export-options">\n              <div class="export-format-group">\n                <label class="export-format-option">\n                  <input type="radio" name="export-format" value="png" checked>\n                  <span class="export-format-icon">🖼️</span>\n                  <div class="export-format-info">\n                    <span class="export-format-title">PNG Image</span>\n                    <span class="export-format-description">High quality image, best for sharing</span>\n                  </div>\n                </label>\n                <label class="export-format-option">\n                  <input type="radio" name="export-format" value="svg">\n                  <span class="export-format-icon">🎨</span>\n                  <div class="export-format-info">\n                    <span class="export-format-title">SVG Vector</span>\n                    <span class="export-format-description">Scalable vector format</span>\n                  </div>\n                </label>\n              </div>\n              <div class="export-actions">\n                <button class="atom-button atom-button--ghost" id="export-cancel">Cancel</button>\n                <button class="atom-button atom-button--secondary" id="export-confirm">Export</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    ');const t=document.getElementById("export-modal");this.setupExportModalListeners(t,e)}setupExportModalListeners(e,t){const n=e.querySelector("#export-modal-close"),s=e.querySelector("#export-cancel"),i=e.querySelector("#export-confirm"),a=e.querySelector(".molecule-modal__backdrop"),o=()=>{e.remove()};n.addEventListener("click",o),s.addEventListener("click",o),i.addEventListener("click",async()=>{const n=e.querySelector('input[name="export-format"]:checked').value,s=(new Date).toISOString().split("T")[0];try{i.textContent="Exporting...",i.disabled=!0,"png"===n?await this.exportAsPNG(t,{filename:`mind-map-${s}.png`,width:1200,height:800,scale:2}):"svg"===n&&await this.exportAsSVG(t,{filename:`mind-map-${s}.svg`,width:1200,height:800}),o()}catch(e){console.error("Export failed:",e),alert("Export failed: "+e.message),i.textContent="Export",i.disabled=!1}}),a.addEventListener("click",o),document.addEventListener("keydown",function e(t){"Escape"===t.key&&(o(),document.removeEventListener("keydown",e))})}},g=class{constructor(e,t,n="primary",s=!1){this.text=e,this.onClick=t,this.variant=n,this.disabled=s,this.element=null}render(){return this.element||(this.element=document.createElement("button"),this.element.className=this.getClassName(),this.element.textContent=this.text,this.element.disabled=this.disabled,this.element.style.position="relative",this.element.style.zIndex="10",this.element.style.pointerEvents="auto",!this.disabled&&this.onClick?(console.log("Adding click listener to button:",this.text),this.element.addEventListener("click",e=>{console.log("Button clicked:",this.text),this.onClick(e)}),this.element.addEventListener("keydown",this.handleKeyDown.bind(this))):console.log("Button created without click handler:",this.text,"disabled:",this.disabled,"onClick:",!!this.onClick)),this.element}getClassName(){return["atom-button",`atom-button--${this.variant}`,this.disabled?"atom-button--disabled":""].filter(Boolean).join(" ")}handleKeyDown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.onClick&&this.onClick(e))}setText(e){this.text=e,this.element&&(this.element.textContent=e)}setDisabled(e){this.disabled=e,this.element&&(this.element.disabled=e,this.element.className=this.getClassName())}setVariant(e){this.variant=e,this.element&&(this.element.className=this.getClassName())}destroy(){this.element&&this.element.parentNode&&(this.element.removeEventListener("click",this.onClick),this.element.removeEventListener("keydown",this.handleKeyDown),this.element.parentNode.removeChild(this.element)),this.element=null}},b=class{constructor(e={}){this.onLanguageChange=e.onLanguageChange||null,this.compact=e.compact||!1,this.showFlags=!1!==e.showFlags,this.element=null,this.selectElement=null,this.currentLanguage=o.getCurrentLanguage(),this.unsubscribe=o.subscribe(this.handleLanguageChange.bind(this))}render(){if(this.element)return this.element;if(this.element=document.createElement("div"),this.element.className=this.getClassName(),!this.compact){const e=document.createElement("label");e.className="atom-language-selector__label",e.textContent=o.t("buttons.language"),e.setAttribute("for","language-selector"),this.element.appendChild(e)}return this.selectElement=document.createElement("select"),this.selectElement.className="atom-language-selector__select",this.selectElement.id="language-selector",this.selectElement.setAttribute("aria-label",o.t("buttons.language")),this.populateOptions(),this.selectElement.addEventListener("change",this.handleSelectionChange.bind(this)),this.element.appendChild(this.selectElement),this.element}populateOptions(){this.selectElement&&(this.selectElement.innerHTML="",o.getAvailableLanguages().forEach(e=>{const t=document.createElement("option");t.value=e.code,t.textContent=this.formatLanguageName(e),t.selected=e.code===this.currentLanguage,this.selectElement.appendChild(t)}))}formatLanguageName(e){if(this.compact)return e.code.toUpperCase();const t=this.getLanguageFlag(e.code),n=e.nativeName||e.name;return this.showFlags?`${t} ${n}`:n}getLanguageFlag(e){return{pt:"",en:"",es:""}[e]||""}getClassName(){return["atom-language-selector",this.compact?"atom-language-selector--compact":""].filter(Boolean).join(" ")}handleSelectionChange(e){const t=e.target.value;t!==this.currentLanguage&&(o.setLanguage(t),this.onLanguageChange&&this.onLanguageChange(t,this.currentLanguage))}handleLanguageChange(e,t){if(this.currentLanguage=e,this.selectElement&&(this.selectElement.value=e,this.populateOptions()),!this.compact){const e=this.element?.querySelector(".atom-language-selector__label");e&&(e.textContent=o.t("buttons.language"))}}setCompact(e){this.compact=e,this.element&&(this.element.className=this.getClassName(),this.populateOptions())}setShowFlags(e){this.showFlags=e,this.selectElement&&this.populateOptions()}getCurrentLanguage(){return this.currentLanguage}focus(){this.selectElement&&this.selectElement.focus()}destroy(){this.unsubscribe&&this.unsubscribe(),this.selectElement&&this.selectElement.removeEventListener("change",this.handleSelectionChange),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.selectElement=null}},f=class{constructor(e={}){this.variant=e.variant||"default",this.actions=e.actions||[],this.showLanguageSelector=!1!==e.showLanguageSelector,this.orientation=e.orientation||"horizontal",this.element=null,this.buttons=new Map,this.languageSelector=null,this.unsubscribe=o.subscribe(this.updateButtonTexts.bind(this))}render(){return this.element||(this.element=document.createElement("div"),this.element.className=this.getClassName(),this.element.setAttribute("role","toolbar"),this.element.setAttribute("aria-label",o.t("accessibility.toolbar")),this.createButtons(),this.showLanguageSelector&&this.createLanguageSelector()),this.element}createButtons(){this.actions.forEach((e,t)=>{const n=new g(this.getButtonText(e.key),e.onClick,e.variant||"secondary",e.disabled||!1),s=n.render();e.ariaLabel&&s.setAttribute("aria-label",o.t(e.ariaLabel)),e.title&&s.setAttribute("title",o.t(e.title)),e.icon&&(s.innerHTML=`${e.icon} ${s.textContent}`,s.classList.add("atom-button--with-icon")),this.buttons.set(e.key,n),this.element.appendChild(s),e.separator&&t<this.actions.length-1&&this.addSeparator()})}createLanguageSelector(){this.addSeparator(),this.languageSelector=new b({compact:"compact"===this.variant||"mobile"===this.variant,showFlags:"compact"!==this.variant,onLanguageChange:this.handleLanguageChange.bind(this)});const e=this.languageSelector.render();this.element.appendChild(e)}addSeparator(){const e=document.createElement("div");return e.className="molecule-toolbar__separator",e.setAttribute("role","separator"),this.element.appendChild(e),e}getButtonText(e){return o.t({theme:"buttons.theme",export:"buttons.export",help:"buttons.help",clear:"buttons.clear",example:"buttons.example","zoom-in":"buttons.zoomIn","zoom-out":"buttons.zoomOut","fit-screen":"buttons.fitScreen",save:"buttons.save",settings:"buttons.settings"}[e]||`buttons.${e}`)}getClassName(){return["molecule-toolbar",`molecule-toolbar--${this.variant}`,`molecule-toolbar--${this.orientation}`].filter(Boolean).join(" ")}updateButtonTexts(){this.buttons.forEach((e,t)=>{const n=this.getButtonText(t);e.setText(n)}),this.element&&this.element.setAttribute("aria-label",o.t("accessibility.toolbar"))}handleLanguageChange(e,t){console.log(`Language changed from ${t} to ${e}`)}addAction(e){this.actions.push(e),this.element&&(this.element.innerHTML="",this.buttons.clear(),this.createButtons(),this.showLanguageSelector&&this.createLanguageSelector())}removeAction(e){const t=this.actions.findIndex(t=>t.key===e);if(t>-1){this.actions.splice(t,1);const n=this.buttons.get(e);n&&(n.destroy(),this.buttons.delete(e)),this.element&&(this.element.innerHTML="",this.createButtons(),this.showLanguageSelector&&this.createLanguageSelector())}}updateAction(e,t){const n=this.actions.find(t=>t.key===e);if(n){Object.assign(n,t);const s=this.buttons.get(e);s&&(t.text&&s.setText(this.getButtonText(e)),void 0!==t.disabled&&s.setDisabled(t.disabled),t.variant&&s.setVariant(t.variant))}}enableAction(e){this.updateAction(e,{disabled:!1})}disableAction(e){this.updateAction(e,{disabled:!0})}showAction(e){const t=this.buttons.get(e);t&&t.element&&(t.element.style.display="")}hideAction(e){const t=this.buttons.get(e);t&&t.element&&(t.element.style.display="none")}setVariant(e){if(this.variant=e,this.element&&(this.element.className=this.getClassName(),this.languageSelector)){const t="compact"===e||"mobile"===e;this.languageSelector.setCompact(t),this.languageSelector.setShowFlags("compact"!==e)}}setOrientation(e){this.orientation=e,this.element&&(this.element.className=this.getClassName())}focus(){const e=this.element?.querySelector(".atom-button");e&&e.focus()}setupKeyboardNavigation(){this.element&&this.element.addEventListener("keydown",e=>{const t=Array.from(this.element.querySelectorAll(".atom-button:not([disabled])")),n=t.findIndex(e=>e===document.activeElement);let s=n;switch(e.key){case"ArrowRight":case"ArrowDown":s=(n+1)%t.length;break;case"ArrowLeft":case"ArrowUp":s=n>0?n-1:t.length-1;break;case"Home":s=0;break;case"End":s=t.length-1;break;default:return}e.preventDefault(),t[s]?.focus()})}destroy(){this.unsubscribe&&this.unsubscribe(),this.buttons.forEach(e=>e.destroy()),this.buttons.clear(),this.languageSelector&&this.languageSelector.destroy(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null}},v=class{constructor(e={}){this.title=e.title||o.t("header.title"),this.subtitle=e.subtitle||o.t("header.subtitle"),this.showToolbar=!1!==e.showToolbar,this.onThemeToggle=e.onThemeToggle||null,this.onExport=e.onExport||null,this.onExample=e.onExample||null,this.onHelp=e.onHelp||null,this.element=null,this.titleElement=null,this.subtitleElement=null,this.toolbar=null,this.unsubscribe=o.subscribe(this.updateLabels.bind(this))}render(){if(this.element)return this.element;this.element=document.createElement("header"),this.element.className="organism-header",this.element.setAttribute("role","banner");const e=document.createElement("div");return e.className="organism-header__container",this.createTitleSection(e),this.showToolbar&&this.createToolbar(e),this.element.appendChild(e),this.element}createTitleSection(e){const t=document.createElement("div");t.className="organism-header__title-section",this.titleElement=document.createElement("h1"),this.titleElement.className="organism-header__title",this.titleElement.textContent=this.title,t.appendChild(this.titleElement),this.subtitle&&(this.subtitleElement=document.createElement("p"),this.subtitleElement.className="organism-header__subtitle",this.subtitleElement.textContent=this.subtitle,t.appendChild(this.subtitleElement)),e.appendChild(t)}createToolbar(e){const t=[{key:"theme",variant:"secondary",onClick:this.handleThemeToggle.bind(this),ariaLabel:"buttons.theme",title:"buttons.theme"},{key:"example",variant:"secondary",onClick:this.handleExample.bind(this),ariaLabel:"buttons.example",title:"buttons.example"},{key:"export",variant:"secondary",onClick:this.handleExport.bind(this),ariaLabel:"buttons.export",title:"buttons.export"},{key:"help",variant:"secondary",onClick:this.handleHelp.bind(this),ariaLabel:"buttons.help",title:"buttons.help"}];this.toolbar=new f({variant:"compact",actions:t,showLanguageSelector:!0,orientation:"horizontal"});const n=this.toolbar.render();n.classList.add("organism-header__toolbar"),e.appendChild(n)}handleThemeToggle(){console.log("Theme toggle clicked!"),this.onThemeToggle?this.onThemeToggle():r.cycleTheme()}handleExample(){console.log("Example button clicked!"),this.onExample?this.onExample():console.log("Example functionality not implemented")}handleExport(){console.log("Export button clicked!"),this.onExport?this.onExport():console.log("Export functionality not implemented")}handleHelp(){console.log("Help button clicked!"),this.onHelp?this.onHelp():console.log("Help functionality not implemented")}updateLabels(){this.titleElement&&(this.titleElement.textContent=o.t("header.title")),this.subtitleElement&&(this.subtitleElement.textContent=o.t("header.subtitle")),document.title=o.t("app.title")}setTitle(e){this.title=e,this.titleElement&&(this.titleElement.textContent=e)}setSubtitle(e){if(this.subtitle=e,this.subtitleElement)this.subtitleElement.textContent=e;else if(e){this.subtitleElement=document.createElement("p"),this.subtitleElement.className="organism-header__subtitle",this.subtitleElement.textContent=e;const t=this.element?.querySelector(".organism-header__title-section");t&&t.appendChild(this.subtitleElement)}}hideToolbar(){this.toolbar&&this.toolbar.element&&(this.toolbar.element.style.display="none")}showToolbar(){this.toolbar&&this.toolbar.element&&(this.toolbar.element.style.display="flex")}enableAction(e){this.toolbar&&this.toolbar.enableAction(e)}disableAction(e){this.toolbar&&this.toolbar.disableAction(e)}updateAction(e,t){this.toolbar&&this.toolbar.updateAction(e,t)}setLoading(e){e?(this.element?.classList.add("organism-header--loading"),this.disableAction("export")):(this.element?.classList.remove("organism-header--loading"),this.enableAction("export"))}setMobileMode(e){e?(this.element?.classList.add("organism-header--mobile"),this.toolbar&&this.toolbar.setVariant("mobile")):(this.element?.classList.remove("organism-header--mobile"),this.toolbar&&this.toolbar.setVariant("compact"))}animateIn(){this.element&&(this.element.classList.add("organism-header--animate-in"),setTimeout(()=>{this.element.classList.remove("organism-header--animate-in")},500))}focus(){this.toolbar?this.toolbar.focus():this.titleElement&&this.titleElement.focus()}destroy(){this.unsubscribe&&this.unsubscribe(),this.toolbar&&this.toolbar.destroy(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.titleElement=null,this.subtitleElement=null,this.toolbar=null}},y=class{constructor(e={}){this.type=e.type||"text",this.placeholder=e.placeholder||"",this.value=e.value||"",this.disabled=e.disabled||!1,this.required=e.required||!1,this.multiline=e.multiline||!1,this.rows=e.rows||3,this.onChange=e.onChange||null,this.onFocus=e.onFocus||null,this.onBlur=e.onBlur||null,this.ariaLabel=e.ariaLabel||"",this.id=e.id||`text-input-${Date.now()}`,this.element=null}render(){return this.element||(this.element=this.multiline?document.createElement("textarea"):document.createElement("input"),this.setupElement(),this.attachEventListeners()),this.element}setupElement(){this.element.className=this.getClassName(),this.element.placeholder=this.placeholder,this.element.value=this.value,this.element.disabled=this.disabled,this.element.required=this.required,this.element.id=this.id,this.ariaLabel&&this.element.setAttribute("aria-label",this.ariaLabel),this.multiline?(this.element.rows=this.rows,this.element.setAttribute("resize","vertical")):this.element.type=this.type}getClassName(){return["atom-text-input",this.multiline?"atom-text-input--multiline":"",this.disabled?"atom-text-input--disabled":""].filter(Boolean).join(" ")}attachEventListeners(){this.onChange&&this.element.addEventListener("input",e=>{this.value=e.target.value,this.onChange(e.target.value,e)}),this.onFocus&&this.element.addEventListener("focus",this.onFocus),this.onBlur&&this.element.addEventListener("blur",this.onBlur),this.multiline&&this.element.addEventListener("input",this.autoResize.bind(this))}autoResize(){this.multiline&&this.element&&(this.element.style.height="auto",this.element.style.height=this.element.scrollHeight+"px")}getValue(){return this.element?this.element.value:this.value}setValue(e){this.value=e,this.element&&(this.element.value=e,this.multiline&&this.autoResize())}setPlaceholder(e){this.placeholder=e,this.element&&(this.element.placeholder=e)}setDisabled(e){this.disabled=e,this.element&&(this.element.disabled=e,this.element.className=this.getClassName())}focus(){this.element&&this.element.focus()}blur(){this.element&&this.element.blur()}select(){this.element&&this.element.select()}setSelectionRange(e,t){this.element&&this.element.setSelectionRange&&this.element.setSelectionRange(e,t)}insertTextAtCursor(e){if(!this.element)return;const t=this.element.selectionStart,n=this.element.selectionEnd,s=this.element.value,i=s.slice(0,t)+e+s.slice(n);this.setValue(i);const a=t+e.length;setTimeout(()=>{this.setSelectionRange(a,a)},0)}destroy(){this.element&&this.element.parentNode&&(this.element.removeEventListener("input",this.onChange),this.element.removeEventListener("focus",this.onFocus),this.element.removeEventListener("blur",this.onBlur),this.element.parentNode.removeChild(this.element)),this.element=null}},x=class{constructor(e={}){this.value=e.value||"",this.placeholder=e.placeholder||o.t("editor.placeholder"),this.onChange=e.onChange||null,this.onFocus=e.onFocus||null,this.onBlur=e.onBlur||null,this.autoSave=!1!==e.autoSave,this.showStats=!1!==e.showStats,this.enableShortcuts=!1!==e.enableShortcuts,this.element=null,this.textInput=null,this.statsElement=null,this.statusElement=null,this.isDirty=!1,this.lastSavedValue=this.value,this.autoSaveTimeout=null,this.stats={characters:0,words:0,lines:0},this.unsubscribe=o.subscribe(this.updateLabels.bind(this))}render(){return this.element||(this.element=document.createElement("div"),this.element.className="molecule-text-editor",this.createTextInput(),this.showStats&&this.createStatsBar(),this.autoSave&&this.setupAutoSave(),this.enableShortcuts&&this.setupKeyboardShortcuts(),this.updateStats()),this.element}createTextInput(){this.textInput=new y({multiline:!0,rows:20,placeholder:this.placeholder,value:this.value,ariaLabel:o.t("editor.title"),onChange:this.handleChange.bind(this),onFocus:this.handleFocus.bind(this),onBlur:this.handleBlur.bind(this)});const e=this.textInput.render();e.classList.add("molecule-text-editor__input"),this.element.appendChild(e)}createStatsBar(){const e=document.createElement("div");e.className="molecule-text-editor__stats",this.statsElement=document.createElement("div"),this.statsElement.className="molecule-text-editor__stats-display",e.appendChild(this.statsElement),this.statusElement=document.createElement("div"),this.statusElement.className="molecule-text-editor__status",e.appendChild(this.statusElement),this.element.appendChild(e),this.updateStatsDisplay(),this.updateStatusDisplay()}handleChange(e,t){this.value=e,this.isDirty=e!==this.lastSavedValue,this.updateStats(),this.autoSave&&this.triggerAutoSave(),this.onChange&&this.onChange(e,t,this.stats),this.updateStatusDisplay()}handleFocus(e){this.onFocus&&this.onFocus(e)}handleBlur(e){this.onBlur&&this.onBlur(e),this.autoSave&&this.isDirty&&this.save()}updateStats(){const e=this.value||"";this.stats.characters=e.length,this.stats.words=e.trim()?e.trim().split(/\s+/).length:0,this.stats.lines=e.split("\n").length,this.statsElement&&this.updateStatsDisplay()}updateStatsDisplay(){if(!this.statsElement)return;const e=[`${this.stats.characters} ${o.t("editor.characterCount")}`,`${this.stats.words} ${o.t("editor.wordCount")}`,`${this.stats.lines} ${o.t("editor.lineCount")}`];this.statsElement.textContent=e.join(" • ")}updateStatusDisplay(){this.statusElement&&(this.isDirty?(this.statusElement.textContent=o.t("editor.unsaved"),this.statusElement.className="molecule-text-editor__status molecule-text-editor__status--unsaved"):(this.statusElement.textContent=o.t("editor.saved"),this.statusElement.className="molecule-text-editor__status molecule-text-editor__status--saved"))}updateLabels(){this.textInput&&this.textInput.setPlaceholder(o.t("editor.placeholder")),this.updateStatsDisplay(),this.updateStatusDisplay()}setupAutoSave(){try{const e=localStorage.getItem("mark2-editor-content");e&&!this.value&&(this.setValue(e),this.lastSavedValue=e,this.isDirty=!1)}catch(e){console.warn("Could not load auto-saved content:",e)}}triggerAutoSave(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=setTimeout(()=>{this.save()},2e3)}save(){try{localStorage.setItem("mark2-editor-content",this.value),this.lastSavedValue=this.value,this.isDirty=!1,this.updateStatusDisplay(),this.showSavedIndicator()}catch(e){console.error("Could not save content:",e),this.showError(o.t("errors.saveError"))}}showSavedIndicator(){this.statusElement&&(this.statusElement.classList.add("molecule-text-editor__status--flash"),setTimeout(()=>{this.statusElement.classList.remove("molecule-text-editor__status--flash")},1e3))}showError(e){this.statusElement&&(this.statusElement.textContent,this.statusElement.textContent=e,this.statusElement.className="molecule-text-editor__status molecule-text-editor__status--error",setTimeout(()=>{this.updateStatusDisplay()},3e3))}setupKeyboardShortcuts(){this.textInput&&this.textInput.element&&this.textInput.element.addEventListener("keydown",e=>{if((e.ctrlKey||e.metaKey)&&"s"===e.key&&(e.preventDefault(),this.save()),(e.ctrlKey||e.metaKey)&&"b"===e.key&&(e.preventDefault(),this.insertMarkdown("**","**")),(e.ctrlKey||e.metaKey)&&"i"===e.key&&(e.preventDefault(),this.insertMarkdown("*","*")),(e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),this.insertMarkdown("[","](url)")),"Tab"===e.key){const t=this.textInput.element.selectionStart,n=this.value.lastIndexOf("\n",t-1)+1,s=this.value.substring(n,t);(s.match(/^\s*[-*+]\s/)||s.match(/^\s*\d+\.\s/))&&(e.preventDefault(),this.indentLine(e.shiftKey?-1:1))}})}insertMarkdown(e,t=""){if(!this.textInput)return;const n=this.textInput.element,s=n.selectionStart,i=n.selectionEnd,a=this.value.substring(s,i),o=e+a+t;this.textInput.insertTextAtCursor(o);const r=s+e.length+a.length;setTimeout(()=>{n.setSelectionRange(r,r)},0)}indentLine(e){if(!this.textInput)return;const t=this.textInput.element,n=t.selectionStart,s=this.value.lastIndexOf("\n",n-1)+1,i=this.value.indexOf("\n",n),a=-1===i?this.value.length:i,o=this.value.substring(s,a);let r;r=e>0?"  "+o:o.replace(/^ {2}/,"");const l=this.value.substring(0,s)+r+this.value.substring(a);this.setValue(l);const d=n+(r.length-o.length);setTimeout(()=>{t.setSelectionRange(d,d)},0)}getValue(){return this.value}setValue(e){this.value=e,this.textInput&&this.textInput.setValue(e),this.updateStats(),this.isDirty=e!==this.lastSavedValue,this.updateStatusDisplay()}clear(){this.setValue("")}focus(){this.textInput&&this.textInput.focus()}insertText(e){this.textInput&&this.textInput.insertTextAtCursor(e)}getStats(){return{...this.stats}}isDirtyContent(){return this.isDirty}destroy(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout),this.autoSave&&this.isDirty&&this.save(),this.unsubscribe&&this.unsubscribe(),this.textInput&&this.textInput.destroy(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.textInput=null,this.statsElement=null,this.statusElement=null}},E=class{constructor(e={}){this.onChange=e.onChange||null,this.onFocus=e.onFocus||null,this.onBlur=e.onBlur||null,this.showToolbar=!1!==e.showToolbar,this.autoSave=!1!==e.autoSave,this.showStats=!1!==e.showStats,this.element=null,this.headerElement=null,this.titleElement=null,this.toolbar=null,this.textEditor=null,this.isVisible=!0,this.isMinimized=!1,this.unsubscribe=o.subscribe(this.updateLabels.bind(this))}render(){return this.element||(this.element=document.createElement("section"),this.element.className="organism-editor-panel",this.element.setAttribute("role","region"),this.element.setAttribute("aria-label",o.t("editor.title")),this.createHeader(),this.createContent(),this.loadExample()),this.element}createHeader(){this.headerElement=document.createElement("div"),this.headerElement.className="organism-editor-panel__header",this.titleElement=document.createElement("h2"),this.titleElement.className="organism-editor-panel__title",this.titleElement.textContent=o.t("editor.title"),this.headerElement.appendChild(this.titleElement),this.showToolbar&&this.createToolbar(),this.element.appendChild(this.headerElement)}createToolbar(){const e=[{key:"clear",variant:"ghost",onClick:this.handleClear.bind(this),ariaLabel:"buttons.clear",title:"buttons.clear"},{key:"example",variant:"ghost",onClick:this.handleLoadExample.bind(this),ariaLabel:"buttons.example",title:"buttons.example"}];this.toolbar=new f({variant:"compact",actions:e,showLanguageSelector:!1,orientation:"horizontal"});const t=this.toolbar.render();t.classList.add("organism-editor-panel__toolbar"),this.headerElement.appendChild(t)}createContent(){const e=document.createElement("div");e.className="organism-editor-panel__content",this.textEditor=new x({placeholder:o.t("editor.placeholder"),onChange:this.handleChange.bind(this),onFocus:this.handleFocus.bind(this),onBlur:this.handleBlur.bind(this),autoSave:this.autoSave,showStats:this.showStats,enableShortcuts:!0});const t=this.textEditor.render();e.appendChild(t),this.element.appendChild(e)}handleChange(e,t,n){this.onChange&&this.onChange(e,n,this)}handleFocus(e){this.element.classList.add("organism-editor-panel--focused"),this.onFocus&&this.onFocus(e,this)}handleBlur(e){this.element.classList.remove("organism-editor-panel--focused"),this.onBlur&&this.onBlur(e,this)}handleClear(){this.clear()}handleLoadExample(){this.loadExample()}updateLabels(){this.titleElement&&(this.titleElement.textContent=o.t("editor.title")),this.element&&this.element.setAttribute("aria-label",o.t("editor.title"))}getValue(){return this.textEditor?this.textEditor.getValue():""}setValue(e){this.textEditor&&this.textEditor.setValue(e)}clear(){this.textEditor&&this.textEditor.clear()}insertText(e){this.textEditor&&this.textEditor.insertText(e)}loadExample(){this.setValue("# Atomic Design\n\n## Conceitos Fundamentais\n\nO Atomic Design é uma metodologia para criar sistemas de design escaláveis e reutilizáveis.\n\n## Átomos\n### Elementos básicos\n- Botões\n- Inputs de texto\n- Labels\n- Ícones\n- Cores\n- Tipografia\n\n### Características\n- Não podem ser decompostos\n- Elementos HTML básicos\n- Propriedades fundamentais\n\n## Moléculas\n### Grupos de átomos\n- Formulários de busca\n- Barras de navegação\n- Cards de produto\n- Campos de formulário\n\n### Características\n- Combinam múltiplos átomos\n- Têm função específica\n- Reutilizáveis\n\n## Organismos\n### Seções complexas\n- Header completo\n- Sidebar com navegação\n- Footer com links\n- Lista de produtos\n\n### Características\n- Combinam moléculas e átomos\n- Seções distintas da interface\n- Contexto específico\n\n## Templates\n### Estruturas de página\n- Layout de homepage\n- Sistema de grid\n- Wireframes\n- Estrutura de conteúdo\n\n### Características\n- Esqueleto da página\n- Sem conteúdo real\n- Foco na estrutura\n\n## Páginas\n### Instâncias finais\n- Homepage com conteúdo real\n- Dashboard do usuário\n- Página de configurações\n- Página de produto\n\n### Características\n- Templates com dados reais\n- Experiência final do usuário\n- Casos de uso específicos")}getStats(){return this.textEditor?this.textEditor.getStats():{characters:0,words:0,lines:0}}focus(){this.textEditor&&this.textEditor.focus()}show(){this.isVisible=!0,this.element&&(this.element.style.display="flex",this.element.classList.remove("organism-editor-panel--hidden"),this.element.classList.add("organism-editor-panel--visible"))}hide(){this.isVisible=!1,this.element&&(this.element.classList.remove("organism-editor-panel--visible"),this.element.classList.add("organism-editor-panel--hidden"),setTimeout(()=>{this.isVisible||(this.element.style.display="none")},300))}minimize(){this.isMinimized=!0,this.element&&this.element.classList.add("organism-editor-panel--minimized")}maximize(){this.isMinimized=!1,this.element&&this.element.classList.remove("organism-editor-panel--minimized")}toggleMinimize(){this.isMinimized?this.maximize():this.minimize()}setLoading(e){e?(this.element?.classList.add("organism-editor-panel--loading"),this.toolbar&&(this.toolbar.disableAction("clear"),this.toolbar.disableAction("example"))):(this.element?.classList.remove("organism-editor-panel--loading"),this.toolbar&&(this.toolbar.enableAction("clear"),this.toolbar.enableAction("example")))}setMobileMode(e){e?(this.element?.classList.add("organism-editor-panel--mobile"),this.toolbar&&this.toolbar.setVariant("mobile")):(this.element?.classList.remove("organism-editor-panel--mobile"),this.toolbar&&this.toolbar.setVariant("compact"))}animateIn(){this.element&&(this.element.classList.add("organism-editor-panel--animate-in"),setTimeout(()=>{this.element.classList.remove("organism-editor-panel--animate-in")},500))}exportContent(){return{content:this.getValue(),stats:this.getStats(),timestamp:(new Date).toISOString(),language:o.getCurrentLanguage()}}importContent(e){return!(!e||!e.content||(this.setValue(e.content),0))}showError(e){this.element?.classList.add("organism-editor-panel--error"),this.textEditor&&this.textEditor.showError&&this.textEditor.showError(e),setTimeout(()=>{this.element?.classList.remove("organism-editor-panel--error")},3e3)}destroy(){this.unsubscribe&&this.unsubscribe(),this.toolbar&&this.toolbar.destroy(),this.textEditor&&this.textEditor.destroy(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.headerElement=null,this.titleElement=null,this.toolbar=null,this.textEditor=null}};const w=new class{constructor(){this.isInitialized=!1,this.isMobile=window.innerWidth<=767,this.currentView=this.isMobile?"editor":"split",this.header=null,this.editorPanel=null,this.mindMapContainer=null,this.mindMapRenderer=null,this.mobileNav=null,this.currentMarkdown="",this.currentMindMapData=null,this.isGenerating=!1,this.appElement=null,this.mainElement=null,this.handleResize=this.handleResize.bind(this),this.handleMarkdownChange=this.handleMarkdownChange.bind(this)}async init(){try{if(console.log("Initializing mark2 application..."),"loading"===document.readyState&&await new Promise(e=>{document.addEventListener("DOMContentLoaded",e)}),await this.initializeManagers(),this.appElement=document.getElementById("app"),!this.appElement)throw new Error("App container element not found");this.initializeComponents(),this.setupEventListeners(),this.setupResponsive(),this.render(),this.animateIn(),this.isInitialized=!0,console.log("mark2 application initialized successfully")}catch(e){console.error("Failed to initialize mark2 application:",e),this.showError("Failed to initialize application: "+e.message)}}async initializeManagers(){console.log(`Language: ${o.getCurrentLanguage()}`),console.log(`Theme: ${r.getCurrentTheme()}`),document.title=o.t("app.title")}initializeComponents(){this.header=new v({onThemeToggle:this.handleThemeToggle.bind(this),onExport:this.handleExport.bind(this),onExample:this.handleExample.bind(this),onHelp:this.handleHelp.bind(this)}),this.editorPanel=new E({onChange:this.handleMarkdownChange,showToolbar:!0,autoSave:!0,showStats:!0}),this.isMobile&&this.setupMobileNavigation()}setupEventListeners(){window.addEventListener("resize",this.handleResize),document.addEventListener("keydown",this.handleKeyboardShortcuts.bind(this)),o.subscribe(this.handleLanguageChange.bind(this)),r.subscribe(this.handleThemeChange.bind(this)),window.addEventListener("beforeunload",this.handleBeforeUnload.bind(this))}setupResponsive(){this.updateResponsiveState(),"orientation"in screen&&screen.orientation.addEventListener("change",()=>{setTimeout(()=>this.updateResponsiveState(),100)})}setupMobileNavigation(){if(this.mobileNav=document.querySelector(".organism-mobile-nav"),this.mobileNav){const e=this.mobileNav.querySelector("#mobile-editor-tab"),t=this.mobileNav.querySelector("#mobile-mindmap-tab");e&&t&&(e.addEventListener("click",()=>this.setMobileView("editor")),t.addEventListener("click",()=>this.setMobileView("mindmap")))}}render(){this.connectToExistingHTML(),this.updateUITexts(),this.updateViewState()}connectToExistingHTML(){console.log("Connecting to existing HTML elements..."),this.connectHeaderButtons(),this.connectEditorElements(),this.connectMindMapContainer(),this.connectMobileNavigation()}connectHeaderButtons(){const e=document.getElementById("language-toggle");e&&(console.log("Connecting language button"),e.addEventListener("click",this.handleLanguageToggle.bind(this)));const t=document.getElementById("theme-toggle");t&&(console.log("Connecting theme button"),t.addEventListener("click",this.handleThemeToggle.bind(this)));const n=document.getElementById("export-button");n&&(console.log("Connecting export button"),n.addEventListener("click",this.handleExport.bind(this)));const s=document.getElementById("help-button");s&&(console.log("Connecting help button"),s.addEventListener("click",this.handleHelp.bind(this))),this.connectLanguageModal(),this.connectThemeModal(),this.connectHelpModal()}connectEditorElements(){const e=document.getElementById("markdown-input");e&&(console.log("Connecting markdown input"),e.addEventListener("input",e=>{this.handleMarkdownChange(e.target.value)}));const t=document.getElementById("clear-button");t&&(console.log("Connecting clear button"),t.addEventListener("click",()=>{e&&(e.value=""),this.handleMarkdownChange("")}));const n=document.getElementById("example-button");n&&(console.log("Connecting example button"),n.addEventListener("click",this.handleExample.bind(this)))}connectMindMapContainer(){this.mindMapContainer=document.getElementById("mind-map-container"),this.mindMapContainer&&(console.log("Connected to mind map container"),this.mindMapRenderer=new u(this.mindMapContainer),console.log("Mind map renderer initialized"),this.connectMindMapControls())}connectMindMapControls(){const e=document.getElementById("zoom-in-button"),t=document.getElementById("zoom-out-button"),n=document.getElementById("fit-screen-button");e&&this.mindMapRenderer&&e.addEventListener("click",()=>{console.log("Zoom in clicked"),this.mindMapRenderer.zoomIn()}),t&&this.mindMapRenderer&&t.addEventListener("click",()=>{console.log("Zoom out clicked"),this.mindMapRenderer.zoomOut()}),n&&this.mindMapRenderer&&n.addEventListener("click",()=>{console.log("Fit screen clicked"),this.mindMapRenderer.resetView()})}connectMobileNavigation(){const e=document.getElementById("mobile-editor-tab"),t=document.getElementById("mobile-mindmap-tab");e&&t&&(console.log("Connecting mobile navigation"),e.addEventListener("click",()=>this.setMobileView("editor")),t.addEventListener("click",()=>this.setMobileView("mindmap")))}createMindMapContainer(){const e=document.createElement("section");e.className="organism-mind-map",e.setAttribute("role","img"),e.setAttribute("aria-label",o.t("mindMap.title"));const t=document.createElement("div");t.className="organism-mind-map__header";const n=document.createElement("h2");n.className="organism-mind-map__title",n.textContent=o.t("mindMap.title"),t.appendChild(n);const s=document.createElement("div");s.className="molecule-toolbar molecule-toolbar--compact",s.innerHTML=`\n      <button class="atom-button atom-button--ghost atom-button--small" id="zoom-in-button">\n        ${o.t("buttons.zoomIn")}\n      </button>\n      <button class="atom-button atom-button--ghost atom-button--small" id="zoom-out-button">\n        ${o.t("buttons.zoomOut")}\n      </button>\n      <button class="atom-button atom-button--ghost atom-button--small" id="fit-screen-button">\n        ${o.t("buttons.fitScreen")}\n      </button>\n    `,t.appendChild(s),e.appendChild(t);const i=document.createElement("div");i.className="organism-mind-map__content";const a=document.createElement("div");a.id="mind-map-container",a.className="mind-map-container";const r=document.createElement("div");r.id="empty-state",r.className="mind-map-empty",r.innerHTML=`<p>${o.t("mindMap.empty")}</p>`,a.appendChild(r),i.appendChild(a),e.appendChild(i),this.mindMapContainer=e,this.mainElement.appendChild(e)}handleMarkdownChange(e,t){console.log("handleMarkdownChange called with value length:",e.length),console.log("First 100 chars:",e.substring(0,100)),this.currentMarkdown=e,this.generateTimeout&&clearTimeout(this.generateTimeout),this.generateTimeout=setTimeout(()=>{console.log("About to generate mind map for markdown"),this.generateMindMap(e)},500)}async generateMindMap(e){if(e.trim())try{this.setGenerating(!0);const t=(e=>{if(!e||"string"!=typeof e)return{title:"",sections:[],nodes:[],error:null};try{const t=(e=>{if(!e||"string"!=typeof e)return[];const t=/^(#{1,6})\s+(.+)$/gm,n=[];let s;for(;null!==(s=t.exec(e));)n.push({level:s[1].length,text:s[2].trim(),index:s.index,raw:s[0]});return n})(e),n=(e=>{if(!e||"string"!=typeof e)return[];const t=e.split("\n"),n=[];let s=0;for(let e=0;e<t.length;e++){const i=t[e].trim(),a=i.match(/^[-*+]\s+(.+)$/);a&&n.push({text:a[1].trim(),type:"unordered",level:t[e].match(/^\s*/)[0].length/2+1,index:s});const o=i.match(/^\d+\.\s+(.+)$/);o&&n.push({text:o[1].trim(),type:"ordered",level:t[e].match(/^\s*/)[0].length/2+1,index:s}),s+=t[e].length+1}return n})(e);if(e.split("\n"),0===t.length)return{title:"Mind Map",sections:[],nodes:[],error:"No headers found in markdown"};const s={title:t[0].text,level:t[0].level,sections:[],items:[]};let i=null,a=null;for(let e=1;e<t.length;e++){const n=t[e];2===n.level?(i={title:n.text,level:n.level,items:[],subsections:[],startIndex:n.index},s.sections.push(i),a=null):3===n.level&&i&&(a={title:n.text,level:n.level,items:[],startIndex:n.index},i.subsections.push(a))}return n.forEach(e=>{let t=null,n=null;for(const n of s.sections){if(!(n.startIndex<e.index))break;t=n}if(t)for(const i of t.subsections){if(!(i.startIndex<e.index))break;{const a=s.sections.findIndex(e=>e===t)+1,o=s.sections[a];(!o||e.index<o.startIndex)&&(n=i)}}n?n.items.push(e.text):t?t.items.push(e.text):s.items.push(e.text)}),{title:s.title,sections:s.sections,nodes:l(s),error:null}}catch(e){return{title:"",sections:[],nodes:[],error:e.message}}})(e);if(t.error)throw new Error(t.error);const n=h(t,800,600);this.currentMindMapData=n,this.renderMindMapPlaceholder(t)}catch(e){console.error("Error generating mind map:",e),this.showMindMapError(e.message)}finally{this.setGenerating(!1)}else this.showEmptyState()}renderMindMapPlaceholder(e){if(!this.mindMapRenderer)return void console.error("Mind map renderer not initialized");console.log("Rendering mind map with SVG renderer:",e);const t=document.getElementById("loading-indicator"),n=document.getElementById("empty-state"),s=document.getElementById("error-state");t&&(t.style.display="none"),n&&(n.style.display="none"),s&&(s.style.display="none");try{this.mindMapRenderer.render(e),console.log("Mind map rendered successfully")}catch(e){console.error("Error rendering mind map:",e),this.showMindMapError("Erro ao renderizar o mapa mental: "+e.message)}}showEmptyState(){const e=document.getElementById("mind-map-container");e&&(e.innerHTML=`\n        <div class="mind-map-empty">\n          <p>${o.t("mindMap.empty")}</p>\n        </div>\n      `)}showMindMapError(e){const t=document.getElementById("mind-map-container");t&&(t.innerHTML=`\n        <div class="mind-map-error">\n          <p>${o.t("mindMap.error")}</p>\n          <small>${e}</small>\n        </div>\n      `)}setGenerating(e){this.isGenerating=e;const t=document.getElementById("mind-map-container");t&&e&&(t.innerHTML=`\n          <div class="mind-map-loading">\n            <div class="atom-spinner"></div>\n            <p>${o.t("mindMap.generating")}</p>\n          </div>\n        `)}handleThemeToggle(){console.log("handleThemeToggle called - opening theme modal"),this.showThemeModal()}handleExport(){if(console.log("handleExport called"),!this.mindMapRenderer)return void alert("No mind map to export. Please create a mind map first.");const e=this.mindMapContainer.querySelector("svg");if(e)try{p.showExportModal(e)}catch(e){console.error("Export error:",e),alert("Failed to show export options: "+e.message)}else alert("No mind map visualization found. Please create a mind map first.")}handleExample(){console.log("handleExample called");const e=document.getElementById("markdown-input");if(e){const t="# Atomic Design\n\n## Conceitos Fundamentais\n\nO Atomic Design é uma metodologia para criar sistemas de design escaláveis e reutilizáveis.\n\n## Átomos\n### Elementos básicos\n- Botões\n- Inputs de texto\n- Labels\n- Ícones\n- Cores\n- Tipografia\n\n### Características\n- Não podem ser decompostos\n- Elementos HTML básicos\n- Propriedades fundamentais\n\n## Moléculas\n### Grupos de átomos\n- Formulários de busca\n- Barras de navegação\n- Cards de produto\n- Campos de formulário\n\n### Características\n- Combinam múltiplos átomos\n- Têm função específica\n- Reutilizáveis\n\n## Organismos\n### Seções complexas\n- Header completo\n- Sidebar com navegação\n- Footer com links\n- Lista de produtos\n\n### Características\n- Combinam moléculas e átomos\n- Seções distintas da interface\n- Contexto específico\n\n## Templates\n### Estruturas de página\n- Layout de homepage\n- Sistema de grid\n- Wireframes\n- Estrutura de conteúdo\n\n### Características\n- Esqueleto da página\n- Sem conteúdo real\n- Foco na estrutura\n\n## Páginas\n### Instâncias finais\n- Homepage com conteúdo real\n- Dashboard do usuário\n- Página de configurações\n- Página de produto\n\n### Características\n- Templates com dados reais\n- Experiência final do usuário\n- Casos de uso específicos";console.log("Loading example content into textarea"),e.value=t,this.handleMarkdownChange(t),console.log("Example loaded successfully")}else console.error("Markdown input textarea not found");this.isMobile&&(console.log("Setting mobile view to editor"),this.setMobileView("editor"))}handleHelp(){this.showHelpModal()}handleLanguageToggle(){console.log("handleLanguageToggle called - opening language modal"),this.showLanguageModal()}connectThemeModal(){const e=document.getElementById("theme-modal");if(!e)return;const t=document.getElementById("theme-modal-close");t&&t.addEventListener("click",()=>this.hideThemeModal());const n=e.querySelector(".molecule-modal__backdrop");n&&n.addEventListener("click",()=>this.hideThemeModal()),e.querySelectorAll('input[name="theme"]').forEach(e=>{e.addEventListener("change",e=>{e.target.checked&&(console.log("Theme selected:",e.target.value),r.setTheme(e.target.value),this.hideThemeModal())})}),this.updateThemeModalSelection()}showThemeModal(){const e=document.getElementById("theme-modal");if(e){this.updateThemeModalSelection(),e.setAttribute("aria-hidden","false"),e.style.display="flex";const t=e.querySelector('input[name="theme"]:checked');t&&t.focus()}}hideThemeModal(){const e=document.getElementById("theme-modal");e&&(e.setAttribute("aria-hidden","true"),e.style.display="none")}updateThemeModalSelection(){const e=r.getCurrentTheme(),t=document.querySelector(`input[name="theme"][value="${e}"]`);t&&(t.checked=!0)}connectHelpModal(){const e=document.getElementById("help-modal");if(!e)return;const t=document.getElementById("help-modal-close");t&&t.addEventListener("click",()=>this.hideHelpModal());const n=e.querySelector(".molecule-modal__backdrop");n&&n.addEventListener("click",()=>this.hideHelpModal()),e.querySelectorAll(".help-tabs__button").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.getAttribute("data-tab");this.switchHelpTab(t)})}),document.addEventListener("keydown",t=>{if("Escape"===t.key){"false"===e.getAttribute("aria-hidden")&&this.hideHelpModal();const t=document.getElementById("theme-modal");t&&"false"===t.getAttribute("aria-hidden")&&this.hideThemeModal()}})}switchHelpTab(e){document.querySelectorAll(".help-tabs__button").forEach(t=>{t.classList.remove("active"),t.getAttribute("data-tab")===e&&t.classList.add("active")}),document.querySelectorAll(".help-tab-content").forEach(e=>{e.classList.remove("active")});const t=document.getElementById(`tab-${e}`);t&&t.classList.add("active")}showHelpModal(){const e=document.getElementById("help-modal");e&&(e.setAttribute("aria-hidden","false"),e.style.display="flex")}hideHelpModal(){const e=document.getElementById("help-modal");e&&(e.setAttribute("aria-hidden","true"),e.style.display="none")}connectLanguageModal(){const e=document.getElementById("language-modal");if(!e)return;const t=document.getElementById("language-modal-close");t&&t.addEventListener("click",()=>this.hideLanguageModal());const n=e.querySelector(".molecule-modal__backdrop");n&&n.addEventListener("click",()=>this.hideLanguageModal()),e.querySelectorAll('input[name="language"]').forEach(e=>{e.addEventListener("change",e=>{e.target.checked&&(console.log("Language selected:",e.target.value),o.setLanguage(e.target.value),this.hideLanguageModal())})}),this.updateLanguageModalSelection()}showLanguageModal(){const e=document.getElementById("language-modal");if(e){this.updateLanguageModalSelection(),e.setAttribute("aria-hidden","false"),e.style.display="flex";const t=e.querySelector('input[name="language"]:checked');t&&t.focus()}}hideLanguageModal(){const e=document.getElementById("language-modal");e&&(e.setAttribute("aria-hidden","true"),e.style.display="none")}updateLanguageModalSelection(){const e=o.getCurrentLanguage(),t=document.querySelector(`input[name="language"][value="${e}"]`);t&&(t.checked=!0)}handleResize(){const e=this.isMobile;this.isMobile=window.innerWidth<=767,e!==this.isMobile&&this.updateResponsiveState()}updateResponsiveState(){this.isMobile?(document.body.classList.add("mobile-layout"),this.currentView="editor",this.header&&this.header.setMobileMode(!0),this.editorPanel&&this.editorPanel.setMobileMode(!0)):(document.body.classList.remove("mobile-layout"),this.currentView="split",this.header&&this.header.setMobileMode(!1),this.editorPanel&&this.editorPanel.setMobileMode(!1)),this.updateViewState()}setMobileView(e){if(!this.isMobile)return;this.currentView=e,this.updateViewState();const t=document.getElementById("mobile-editor-tab"),n=document.getElementById("mobile-mindmap-tab");t&&n&&(t.setAttribute("aria-pressed","editor"===e?"true":"false"),n.setAttribute("aria-pressed","mindmap"===e?"true":"false"))}updateViewState(){const e=this.editorPanel?.element,t=this.mindMapContainer;e&&t&&(this.isMobile?"editor"===this.currentView?(e.classList.add("active"),t.classList.remove("active")):(e.classList.remove("active"),t.classList.add("active")):(e.classList.add("active"),t.classList.add("active")))}handleKeyboardShortcuts(e){if(e.ctrlKey||e.metaKey)switch(e.key){case",":e.preventDefault(),this.handleHelp();break;case"e":this.isMobile&&(e.preventDefault(),this.setMobileView("editor"));break;case"m":this.isMobile&&(e.preventDefault(),this.setMobileView("mindmap"))}}handleLanguageChange(e){console.log(`Language changed to: ${e}`),document.title=o.t("app.title"),this.updateUITexts()}updateUITexts(){document.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.getAttribute("data-i18n");if("INPUT"===e.tagName&&"text"===e.type){const n=e.getAttribute("data-i18n-attr");n&&n.includes("placeholder")&&(e.placeholder=o.t(t))}else if("TEXTAREA"===e.tagName){const n=e.getAttribute("data-i18n-attr");n&&n.includes("placeholder")&&(e.placeholder=o.t(t))}else{const n=o.t(t);n&&(e.textContent=n)}}),document.querySelectorAll("[data-i18n-attr]").forEach(e=>{const t=e.getAttribute("data-i18n-attr").split(","),n=e.getAttribute("data-i18n");if(n){const s=o.t(n);t.forEach(t=>{const n=t.trim();n&&s&&e.setAttribute(n,s)})}});const e=document.getElementById("markdown-input");e&&(e.placeholder=o.t("editor.placeholder")),this.updateLanguageLabels()}updateLanguageLabels(){const e=document.querySelector('input[value="pt"]').closest(".atom-language-option").querySelector(".atom-language-option__label"),t=document.querySelector('input[value="en"]').closest(".atom-language-option").querySelector(".atom-language-option__label"),n=document.querySelector('input[value="es"]').closest(".atom-language-option").querySelector(".atom-language-option__label");e&&(e.textContent="Português"),t&&(t.textContent="English"),n&&(n.textContent="Español")}handleThemeChange(e){console.log(`Theme changed to: ${e}`)}handleBeforeUnload(e){if(this.editorPanel&&this.editorPanel.textEditor&&this.editorPanel.textEditor.isDirtyContent())return e.preventDefault(),e.returnValue="",""}animateIn(){this.header&&this.header.animateIn(),setTimeout(()=>{this.editorPanel&&this.editorPanel.animateIn()},200)}showError(e){console.error("Application Error:",e);const t=document.createElement("div");t.className="app-error",t.innerHTML=`\n      <h2>Error</h2>\n      <p>${e}</p>\n      <button onclick="location.reload()">Reload</button>\n    `,document.body.appendChild(t)}getMarkdown(){return this.currentMarkdown}setMarkdown(e){this.editorPanel&&this.editorPanel.setValue(e)}exportData(){return{markdown:this.currentMarkdown,mindMap:this.currentMindMapData,language:o.getCurrentLanguage(),theme:r.getCurrentTheme(),timestamp:(new Date).toISOString()}}destroy(){window.removeEventListener("resize",this.handleResize),document.removeEventListener("keydown",this.handleKeyboardShortcuts),window.removeEventListener("beforeunload",this.handleBeforeUnload),this.generateTimeout&&clearTimeout(this.generateTimeout),this.header&&this.header.destroy(),this.editorPanel&&this.editorPanel.destroy(),console.log("mark2 application destroyed")}};w.init().catch(e=>{console.error("Failed to start mark2:",e)}),window.mark2App=w}},n={};function s(e){var i=n[e];if(void 0!==i)return i.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,s),a.exports}s.m=t,e=[],s.O=function(t,n,i,a){if(!n){var o=1/0;for(c=0;c<e.length;c++){n=e[c][0],i=e[c][1],a=e[c][2];for(var r=!0,l=0;l<n.length;l++)(!1&a||o>=a)&&Object.keys(s.O).every(function(e){return s.O[e](n[l])})?n.splice(l--,1):(r=!1,a<o&&(o=a));if(r){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,i,a]},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={792:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,a,o=n[0],r=n[1],l=n[2],d=0;if(o.some(function(t){return 0!==e[t]})){for(i in r)s.o(r,i)&&(s.m[i]=r[i]);if(l)var c=l(s)}for(t&&t(n);d<o.length;d++)a=o[d],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(c)},n=self.webpackChunkmark2=self.webpackChunkmark2||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var i=s.O(void 0,[869],function(){return s(180)});i=s.O(i)}();
//# sourceMappingURL=main.360324ddc9254b98847e.js.map